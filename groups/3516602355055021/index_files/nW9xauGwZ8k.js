if (self.CavalryLogger) { CavalryLogger.start_js(["bqvaO"]); }

__d("FBRTCMessageType",[],function(a,b,c,d,e,f){e.exports={JOIN:0,SERVER_MEDIA_UPDATE:1,HANGUP:2,ICE_CANDIDATE:3,RING:4,DISMISS:5,CONFERENCE_STATE:6,ADD_PARTICIPANTS:7,SUBSCRIPTION:8,CLIENT_MEDIA_UPDATE:9,DATA_MESSAGE:10,REMOVE_PARTICIPANTS:11,PING:18,P2P_PROTOCOL:19,UPDATE:20,NOTIFY:21,CONNECT:22,CLIENT_EVENT:23,SUBSCRIBE:24,UNSUBSCRIBE:25}},null);
__d("WorkGalahadPresenceBadgeDisplayRefetchQuery.graphql",[],function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"id",type:"ID!",defaultValue:null}],b=[{kind:"Variable",name:"id",variableName:"id"}];return{kind:"Request",fragment:{kind:"Fragment",name:"WorkGalahadPresenceBadgeDisplayRefetchQuery",type:"Query",metadata:null,argumentDefinitions:a,selections:[{kind:"LinkedField",alias:null,name:"node",storageKey:null,args:b,concreteType:null,plural:!1,selections:[{kind:"FragmentSpread",name:"WorkGalahadPresenceBadgeDisplay_user",args:null}]}]},operation:{kind:"Operation",name:"WorkGalahadPresenceBadgeDisplayRefetchQuery",argumentDefinitions:a,selections:[{kind:"LinkedField",alias:null,name:"node",storageKey:null,args:b,concreteType:null,plural:!1,selections:[{kind:"ScalarField",alias:null,name:"__typename",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},{kind:"InlineFragment",type:"User",selections:[{kind:"ScalarField",alias:null,name:"name",args:null,storageKey:null}]}]}]},params:{operationKind:"query",name:"WorkGalahadPresenceBadgeDisplayRefetchQuery",id:"2179174592161987",text:null,metadata:{derivedFrom:"WorkGalahadPresenceBadgeDisplay_user",isRefetchableQuery:!0}}}}();e.exports=a},null);
__d("WorkGalahadPresenceBadgeDisplay_user.graphql",["WorkGalahadPresenceBadgeDisplayRefetchQuery.graphql"],function(a,b,c,d,e,f){"use strict";a={kind:"Fragment",name:"WorkGalahadPresenceBadgeDisplay_user",type:"User",metadata:{refetch:{connection:null,operation:b("WorkGalahadPresenceBadgeDisplayRefetchQuery.graphql"),fragmentPathInResult:["node"]}},argumentDefinitions:[],selections:[{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"name",args:null,storageKey:null}]};e.exports=a},null);
__d("ChannelSubdomain",["Event","JSLogger","Run","LogHistory","clearTimeout","setTimeoutAcrossTransitions","WebStorage"],function(a,b,c,d,e,f){var g,h=b("LogHistory").getInstance("channel"),i=b("JSLogger").create("channel"),j="channel_sub:",k=7,l=100*1e3,m=null,n=null;function o(){var a=(g||(g=b("WebStorage"))).getLocalStorage();n&&(b("clearTimeout")(n),n=null);a&&m!=null&&a.removeItem(j+m);m=null}function a(a,c,d){d===void 0&&(d=!1);a=(a-1)*k;d&&(n&&b("clearTimeout")(n),m=n=null);c==null&&(c=Math.floor(Math.random()*a));if(m==null){var e=(g||(g=b("WebStorage"))).getLocalStorage();if(e){d=[];for(var f=0;f<e.length;f++){var p=e.key(f);if(p!=null&&p.indexOf(j)===0){var q=parseInt(p.substr(j.length),10);d[q]=parseInt(e.getItem(p),10)}}q=Date.now()-l;for(var p=0;p<a;p++){f=(p+c)%a;if(!d[f]||d[f]<q){m=f;break}}if(m!=null){f=function a(){if(m==null)return;try{e.setItem(j+m,Date.now().toString())}catch(a){h.warn("subdomain set failed",a.message)}n=b("setTimeoutAcrossTransitions")(a,l/2)};f()}else h.warn("no channel subdomain",d),i.error("subdomain_overflow");typeof window.onpageshow!=="undefined"?b("Event").listen(window,"pagehide",o):b("Run").onUnload(o)}else m=c}return m==null?null:m%k}e.exports={allocate:a,clear:o}},null);
__d("ChatproxyClientErrorsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:ChatproxyClientErrorsLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:ChatproxyClientErrorsLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:ChatproxyClientErrorsLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setAppVersion=function(a){this.$1.app_version=a;return this};c.setBatchSize=function(a){this.$1.batch_size=a;return this};c.setErrorMessage=function(a){this.$1.error_message=a;return this};c.setErrorReason=function(a){this.$1.error_reason=a;return this};c.setErrorText=function(a){this.$1.error_text=a;return this};c.setJsEventTimeMs=function(a){this.$1.js_event_time_ms=a;return this};c.setMultiViewSubscription=function(a){this.$1.multi_view_subscription=a;return this};c.setRequestID=function(a){this.$1.request_id=a;return this};c.setResponseHeaders=function(a){this.$1.response_headers=a;return this};c.setSessionID=function(a){this.$1.session_id=a;return this};c.setSessionIDStr=function(a){this.$1.session_id_str=a;return this};c.setStatusCode=function(a){this.$1.status_code=a;return this};c.setSubscriberID=function(a){this.$1.subscriber_id=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setTopicPrefixes=function(a){this.$1.topic_prefixes=b("GeneratedLoggerUtils").serializeVector(a);return this};c.setURL=function(a){this.$1.url=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};c.setXhrReadyState=function(a){this.$1.xhr_ready_state=a;return this};c.setXhrStatus=function(a){this.$1.xhr_status=a;return this};return a}();c={app_version:!0,batch_size:!0,error_message:!0,error_reason:!0,error_text:!0,js_event_time_ms:!0,multi_view_subscription:!0,request_id:!0,response_headers:!0,session_id:!0,session_id_str:!0,status_code:!0,subscriber_id:!0,time:!0,topic_prefixes:!0,url:!0,weight:!0,xhr_ready_state:!0,xhr_status:!0};e.exports=a},null);
__d("DocRPC",["ErrorUtils","FBLogger"],function(a,b,c,d,e,f){var g,h={_apis:{},_dispatch:function(a){var c;try{a=JSON.parse(a)}catch(b){throw new Error('DocRPC unparsable dispatch: "'+a+'"')}if(Object.prototype.hasOwnProperty.call(h._apis,a.api)){var d=h._apis[a.api];d[a.method]&&(c=(g||(g=b("ErrorUtils"))).applyWithGuard(d[a.method],d,a.args))}c===void 0&&(c=null);return JSON.stringify(c)},publish:function(a,b){h._apis[b]=a},proxy:function(a,c,d){var e={};d.forEach(function(d){e[d]=function(){var e={api:c,method:d,args:Array.prototype.slice.call(arguments)},f;try{if(a.closed)throw new Error("DocRPC window closed");f=a.DocRPC._dispatch(JSON.stringify(e))}catch(a){b("FBLogger")("doc_rpc").catching(a).warn("Encountered an error duing proxy call");return}if(typeof f==="string")try{f=JSON.parse(f)}catch(a){b("FBLogger")("doc_rpc").catching(a).mustfix("DocRPC %s.%s unparsable return: %s",c,d,f);throw new Error("DocRPC "+c+"."+d+' unparsable return: "'+f+'"')}return f}});return e}};e.exports=a.DocRPC=h},null);
__d("ChannelTransport",["AjaxRequest","BanzaiODS","ChannelConstants","ChatproxyClientErrorsTypedLogger","DocRPC","LogHistory","MessengerMQTTGating","TimeSlice","URI","bind","clearTimeout","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f){var g,h="BROWSER_REFUSED_TO_GET_FAILURE_REASON_HEADER",i=b("LogHistory").getInstance("channel");function j(a){var c=new(b("ChatproxyClientErrorsTypedLogger"))();c.setStatusCode(a.status);if(a.xhr!=null){var d;try{d=a.xhr.getResponseHeader("x-fb-chat-failure-reason")}catch(a){d=h}d&&c.setErrorReason(d)}c.setErrorMessage(a.errorType);a.uri!==void 0&&c.setURL(a.uri.getPath());c.log()}function k(){return(1048576*Math.random()|0).toString(36)}function l(a){return a!==null&&a!==void 0&&!isNaN(a)&&isFinite(a)&&0<=a&&a<=6}function m(a,c){var d="";l(a.subdomain)&&(d=a.subdomain+"-");var e=a.host;e=e===null||e===void 0?"edge-chat":a.host;c=new(g||(g=b("URI")))(c).setDomain(d+e+"."+a.domain).setPort(a.port).setSecure(new g(window.location.href).isSecure());return c}function n(a){var c={partition:a.partition,cb:k(),failure:a.pingFailuresOnSubdomain};a.sticky_token&&(c.sticky_token=a.sticky_token);a.sticky_pool&&(c.sticky_pool=a.sticky_pool);c=m(a,"/p").setQueryData(c);i.log("start_p",{uri:c.toString()});var d=new(b("AjaxRequest"))("GET",c);b("AjaxRequest").supportsCORS()&&(d.xhr.withCredentials=!0);var e=function(b){i.log("finish_p",{xhr:b.toJSON?b.toJSON():b,subdomain:a.subdomain,fullHost:a.fullHost})};d.onError=function(c){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendP.error");j(d);e(c);if(a.subdomain===null)return;l(a.subdomain)&&(a.pingFailuresOnSubdomain++,a.subdomain++,a.subdomain>6&&(a.subdomain=0))};d.timeout=a.P_TIMEOUT;d.onSuccess=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendP.success"),e(a)};d.send()}function o(a,c,d){var e=new Image(),f=0,g=function(a){e.abort();return a?c():d()};e.onload=b("TimeSlice").guard(function(){i.log("ping_ok",{duration:Date.now()-f}),b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendPing.success"),g(!0)},"ChannelTransport image.onload");e.onerror=b("TimeSlice").guard(function(){n(a),b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendPing.error"),j(e),g(!1)},"ChannelTransport image.onerror");var h=b("setTimeoutAcrossTransitions")(e.onerror,1e4);e.abort=function(){h&&(b("clearTimeout")(h),h=null),e.onload=e.onerror=null};var l={partition:a.partition,cb:k()};a.sticky_token&&(l.sticky_token=a.sticky_token);a.sticky_pool&&(l.sticky_pool=a.sticky_pool);a.lastRequestErrorReason&&(l.reason=a.lastRequestErrorReason,a.lastRequestErrorReason=null);a.uid&&a.viewerUid&&(l.uid=a.uid,l.viewer_uid=a.viewerUid);f=Date.now();e.src=m(a,"/ajax/chatproxy-ping").setQueryData(l);return e}function a(a,c){var d={channel:a.user_channel,partition:a.partition,clientid:a.sessionID,cb:k(),cap:0,uid:a.uid,viewer_uid:a.viewerUid};a.sticky_token&&(d.sticky_token=a.sticky_token);a.sticky_pool&&(d.sticky_pool=a.sticky_pool);a.profile&&(d.profile=a.profile);a.capabilities&&(d.cap=a.capabilities);d.id=c;c=m(a,"/add_bud").setQueryData(d);var e=new(b("AjaxRequest"))("GET",c);b("AjaxRequest").supportsCORS()&&(e.xhr.withCredentials=!0);e.onError=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendAdditionalBuddy.error"),i.warn("add_buddy_error"),j(e)};e.onSuccess=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendAdditionalBuddy.success"),i.log("add_buddy_ok")};e.timeout=a.P_TIMEOUT;e.send()}function c(a){var c={channel:a.user_channel,partition:a.partition,clientid:a.sessionID,cb:k(),cap:0,uid:a.uid,viewer_uid:a.viewerUid};a.sticky_token&&(c.sticky_token=a.sticky_token);a.sticky_pool&&(c.sticky_pool=a.sticky_pool);a.is_offline||a.shouldSuppressPresence?c.state="offline":c.state="active";if(c.state===a.lastPresenceState)return;a.lastPresenceState=c.state;a.profile&&(c.profile=a.profile);a.capabilities&&(c.cap=a.capabilities);c=m(a,"/active_ping").setQueryData(c);var d=new(b("AjaxRequest"))("GET",c);b("AjaxRequest").supportsCORS()&&(d.xhr.withCredentials=!0);d.onError=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendActivePing.error"),i.warn("active_ping_error"),j(d)};d.onSuccess=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendActivePing.success"),i.log("active_ping_ok")};d.timeout=a.P_TIMEOUT;d.send()}function p(a,c,d,e){var f=new Date(),g=-1;a.userActive>0&&(g=(f-a.userActive)/1e3|0,g<0&&i.warn("idle_regression",{idleTime:g,now:f.getTime(),userActive:a.userActive}));f={channel:a.user_channel,seq:a.seq,partition:a.partition,clientid:a.sessionID,cb:k(),idle:g,qp:"y",cap:0};a.state.aiq&&(f.aiq=a.state.aiq);f.iris_enabled=!b("MessengerMQTTGating").isEnabled();b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","iris_enabled."+(f.iris_enabled?"true":"false"));a.ready&&((a.seqTurSentAt==-1||a.seqTurSentAt==a.seq)&&(f.tur=a.timeUntilReady,f.qpmade=a.queueMade,a.seqTurSentAt=a.seq));f.pws=a.pws;a.sequenceId>0&&(f.isq=a.sequenceId);f.msgs_recv=a.estimatedReceived;a.uid&&a.viewerUid&&(f.uid=a.uid,f.viewer_uid=a.viewerUid);a.sticky_token?f.sticky_token=a.sticky_token:(f.request_batch=1,a.msgr_region&&(f.msgr_region=a.msgr_region));a.sticky_pool&&(f.sticky_pool=a.sticky_pool);"trace_id"in a&&(f.traceid=a.trace_id);a.is_offline||a.shouldSuppressPresence?f.state="offline":a.userActive>0&&g<60&&(f.state="active");a.lastPresenceState=f.state;a.streamingCapable&&(f.mode="stream",f.format="json");a.profile&&(f.profile=a.profile);a.capabilities&&(f.cap=a.capabilities);g=m(a,"/pull").setQueryData(f);f="GET";var h=new(b("AjaxRequest"))(f,g);b("AjaxRequest").supportsCORS()&&(h.xhr.withCredentials=!0);h.timeout=a.streamingCapable?a.STREAMING_TIMEOUT:a.LONGPOLL_TIMEOUT;h.onJSON=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendPull.json"),c(a)};h.onSuccess=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendPull.success"),d(a)};h.onError=function(){var c=this.status==12002&&this._time>=a.MIN_12002_TIMEOUT||this.status==504&&this._time>=a.MIN_504_TIMEOUT,f=c?d:e;c?b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendPull.success"):(b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendPull.error"),j(h));return f&&f.apply(this,arguments)};h.send();a.inStreaming=a.streamingCapable;return h}function q(a){this.manager=a,this.init&&this.init()}function d(a){q.apply(this,arguments)}Object.assign(d.prototype,{logName:"CORS",enterState:function(a,c){this._request&&(this._request.abort(),this._request=null);a=="init"&&b("setTimeoutAcrossTransitions")(b("bind")(this.manager,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),0);if(!/pull|ping/.test(a))return;var d=this.manager;a=="ping"?this._request=o(c,b("bind")(d,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),b("bind")(d,"exitState",{status:b("ChannelConstants").ERROR,stateId:c.stateId})):a=="pull"&&(this._request=p(c,b("bind")(d,"_processTransportData",c.stateId),b("bind")(d,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),b("bind")(d,"exitState",{status:b("ChannelConstants").ERROR,stateId:c.stateId})))}});function f(a){i.log("iframe_init_constructor"),q.apply(this,arguments),this._iframe=document.createElement("iframe"),this._iframe.style.display="none",document.body.appendChild(this._iframe),b("DocRPC").publish(this,"outerTransport")}Object.assign(f.prototype,{logName:"iframe",_initIframe:function(a){i.log("iframe_init_start");window.onchanneliframeready=function(){i.log("iframe_resources");return a.resources};window.onchanneliframeloaded=function(){i.log("iframe_loaded")};if(a){this._iframeURI=m(a,a.path);if(a.resources){var c=this._iframeURI.getDomain();a.resources=a.resources.map(function(a){var d=new(g||(g=b("URI")))(a);return d.getPath().startsWith("/intern/rsrc.php")&&d.getQueryData().origin!==void 0?d.addQueryData("origin",c).toString():a})}}else this._iframeURI="about:blank";this._iframeProxy=null;try{this._iframe.contentWindow.location.replace(this._iframeURI),i.log("iframe_uri_set")}catch(c){i.error("iframe_uri_set_error",c),this.exitState({status:b("ChannelConstants").ERROR,stateId:a.stateId},c+"")}},enterState:function(a,c){a=="init"?this._initIframe(c):/idle|ping|pull/.test(a)?this._iframeProxy?this._iframeProxy.enterState.apply(this._iframeProxy,arguments):a!="idle"&&this.exitState({status:b("ChannelConstants").ERROR,stateId:c.stateId},"iframe not yet loaded"):a=="shutdown"&&this._initIframe()},_processTransportData:function(){this.manager._processTransportData.apply(this.manager,arguments)},exitState:function(a){this.manager.state=="init"&&a.status==b("ChannelConstants").OK&&(this._iframeProxy=b("DocRPC").proxy(this._iframe.contentWindow,"innerTransport",["enterState"],(this._iframeURI+"").replace(/iframe.*/,"")));if(/ping|pull/.test(this.manager.state)&&!this._iframeProxy)return;this.manager.exitState.apply(this.manager,arguments)}});function r(){this.init=this.init.bind(this),q.apply(this,arguments)}Object.assign(r.prototype,{logName:"iframe(inner)",init:function(){b("DocRPC").publish(this,"innerTransport");try{var a=b("DocRPC").proxy(window.parent,"outerTransport",["_processTransportData","exitState"],top.DocRPC.origin);Object.assign(this,a);this.exitState({status:b("ChannelConstants").OK,stateId:1e6})}catch(a){i.error("iframe_inner_init_error",a)}},enterState:function(a,c){this._request&&(this._request.abort(),this._request=null),a=="ping"?this._request=o(c,b("bind")(this,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),b("bind")(this,"exitState",{status:b("ChannelConstants").ERROR,stateId:c.stateId})):a=="pull"&&(this._request=p(c,b("bind")(this,"_processTransportData",c.stateId),b("bind")(this,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),b("bind")(this,"exitState",{status:b("ChannelConstants").ERROR,stateId:c.stateId})))}});e.exports={isSubdomain:l,getURI:m,Transport:q,CORSTransport:d,IframeTransport:f,IframeInnerTransport:r,sendActivePing:c,sendAdditionalBuddyRequest:a}},null);
__d("ChatProxyConnectionState",[],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.auxiliaryIrisQueues={},this.aiq=null}var b=a.prototype;b.subscribeIrisQueue=function(a,b){this.auxiliaryIrisQueues[a]=b,this.updateCaches()};b.unsubscribeIrisQueue=function(a){delete this.auxiliaryIrisQueues[a],this.updateCaches()};b.updateCaches=function(){var a=[];for(var b in this.auxiliaryIrisQueues)Object.prototype.hasOwnProperty.call(this.auxiliaryIrisQueues,b)&&(a.push(b),a.push(this.auxiliaryIrisQueues[b]));a.length===0?this.aiq=null:this.aiq=a.join(",")};return a}();e.exports=a},null);
__d("FBAjaxRequest",["AjaxError","AjaxRequest","getAsyncParams"],function(a,b,c,d,e,f){a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(c,d,e){e=babelHelpers["extends"]({},b("getAsyncParams")(c),e);c=a.call(this,c,d,e)||this;c.$FBAjaxRequest1=e;c.streamMode=!1;return c}var d=c.prototype;d.onJSONSafe=function(){this.json&&(this.json.error&&(this.errorType=b("AjaxError").SERVER_ERROR,this.errorText="AsyncResponse error: "+this.json.error),this.json=this.json.payload),a.prototype.onJSONSafe.call(this)};d.send=function(b){a.prototype.send.call(this,babelHelpers["extends"]({},b,this.$FBAjaxRequest1))};return c}(b("AjaxRequest"));e.exports=a},null);
__d("MovingStat",[],function(a,b,c,d,e,f){a=function(){"use strict";function a(a){this.$1=a>0?a:6e4,this.$2=0,this.$3=0,this.$5={t:new Date(),count:0,v:0},this.$4=this.$5}var b=a.prototype;b.add=function(a){this.$2+=a;this.$3++;var b=new Date();if(b-this.$5.t<1e3){this.$5.v+=a;this.$5.count++;return}this.$5.next={t:b,v:a,count:1};this.$5=this.$5.next;this.$6()};b.tally=function(a){a===void 0&&(a=1e3);this.$6();return{sum:this.$2,count:this.$3,timeAverage:this.$2*a/this.$1}};b.$6=function(){var a=new Date()-this.$1;while(this.$4&&this.$4.next&&this.$4.t<a)this.$2-=this.$4.v,this.$3-=this.$4.count,this.$4=this.$4.next};return a}();e.exports=a},null);
__d("PresenceProperties",["ChannelConstants","InstantGamesPresenceProperties","WorkplaceChatHelper"],function(a,b,c,d,e,f){a=function(){"use strict";function a(){this.$1=b("ChannelConstants").CAPABILITY_VOIP_INTEROP}var c=a.prototype;c.getProperties=function(){b("WorkplaceChatHelper").isDesktopChatApp()&&(this.$1|=b("ChannelConstants").CAPABILITY_ACTIVE_ON_DESKTOP_APP);b("InstantGamesPresenceProperties").isActiveGamePresence()?this.$1|=b("ChannelConstants").CAPABILITY_PLAYING_INSTANT_GAME:this.$1&=~b("ChannelConstants").CAPABILITY_PLAYING_INSTANT_GAME;return this.$1};return a}();c=new a();e.exports=c},null);
__d("RTISession",["invariant","AjaxRequest","BanzaiODS","ChatproxyClientErrorsTypedLogger","ErrorUtils","URI"],function(a,b,c,d,e,f,g){"use strict";var h,i;a=function(){function a(a,b,c,d,e,f,g,h,i,j){this.domain=a,this.topLevelDomain=b,this.port=c,this.edgePoolName=d,this.stickyToken=e,this.loggedInId=f,this.accountId=g,this.clientProfile=h!=null?h:"desktop",this.clientId=i,this.capabilities=j}var c=a.prototype;c.issueRequest=function(a,c,d,e,f){var j=this,k=this.domain+"."+this.topLevelDomain,l=(1048576*Math.random()|0).toString(36);l={cb:l,sticky_token:this.stickyToken,uid:this.loggedInId,viewer_uid:this.accountId,sticky_pool:this.edgePoolName,profile:this.clientProfile,clientid:this.clientId,cap:this.capabilities};for(var m in l)c[m]&&g(0,1632);Object.assign(l,c);a=new(h||(h=b("URI")))(a).setDomain(k).setPort((c=this.port)!=null?c:"").setSecure(new h(window.location.href).isSecure()).setQueryData(l);k=d?"POST":"GET";var n=new(b("AjaxRequest"))(k,a);n.timeout=f!=null?f*1e3:3e4;n.streamMode=!1;n.xhr&&(n.xhr.withCredentials=!0);var o={};n.onSuccess=function(){b("BanzaiODS").bumpEntityKey(2966,"RTISession","request.success")};n.onJSON=function(){o.data=n.json,o.error=null,(i||(i=b("ErrorUtils"))).applyWithGuard(e,j,[o])};n.onError=function(){var a=new Set(),c=null;if(d.subscriptions!=null&&Array.isArray(d.subscriptions)){c=d.subscriptions.length;for(var f=0;f<d.subscriptions.length;f++){var g=d.subscriptions[f].topic.split("/");g.pop();a.add(g.join("/"))}}o.data=null;o.error=n.errorType||"error";b("BanzaiODS").bumpEntityKey(2966,"RTISession","request.error");j.$1(n,a,c);(i||(i=b("ErrorUtils"))).applyWithGuard(e,j,[o])};n.send(JSON.stringify(d));b("BanzaiODS").bumpEntityKey(2966,"RTISession","request.attempt")};c.$1=function(a,c,d){var e=new(b("ChatproxyClientErrorsTypedLogger"))();e.setStatusCode(a.status);if(a.xhr!=null){var f=a.xhr.getResponseHeader("x-fb-chat-failure-reason");f&&e.setErrorReason(f)}e.setSubscriberID(this.loggedInId);e.setSessionIDStr(this.clientId);e.setErrorMessage(a.errorType);e.setErrorText(a.errorText);e.setTopicPrefixes(c);e.setJsEventTimeMs(Math.floor(Date.now()/1e3));d!=null&&e.setBatchSize(d);a.uri&&e.setURL(a.uri.getPath());e.log()};return a}();e.exports=a},null);
__d("ChannelManager",["errorCode","Promise","requireCond","AjaxError","AjaxRequest","Arbiter","AsyncRequest","BanzaiODS","ChannelClientID","ChannelConstants","ChannelInitialData","ChannelSubdomain","ChannelTransport","ChatProxyConnectionState","ChatReliabilityInstrumentation","ChatVisibility","DesktopWebMessageTypesSitevarConfig","DTSG","Env","FantailLogger","FBAjaxRequest","FBMqttChannel","ISB","JSLogger","LogHistory","MovingStat","PresenceCookieManager","PresenceProperties","cr:1167612","PresenceUtil","Random","RTISession","SystemEvents","URI","UserActivity","clearTimeout","emptyFunction","requestAnimationFrameAcrossTransitions","setIntervalAcrossTransitions","setTimeoutAcrossTransitions","gkx"],function(a,b,c,d,e,f,g){var h,i,j=b("JSLogger").create("channel"),k=b("LogHistory").getInstance("channel_manager"),l=b("gkx")("1175809"),m=b("gkx")("1234252"),n=b("gkx")("1271437"),o=null,p=b("emptyFunction"),q=new(b("Promise"))(function(a,b){p=a});function a(a){o=a}var r={idle:{ok:"init!"},init:{ok:"pull!",error:"reconnect",sys_online:"init",sys_timetravel:"init"},pull:{ok:"pull!",error:"ping",error_missing:"pull",error_msg_type:"pull",refresh_0:"reconnect",refresh_110:"reconnect",refresh_111:"reconnect",refresh_112:"pull",refresh_113:"pull",refresh_117:"reconnect"},ping:{ok:"pull!",error:"ping",error_stale:"reconnect!"},reconnect:{ok:"init!",error:"reconnect",sys_online:"reconnect",sys_timetravel:"reconnect"},shutdown:{},_all:{error_max:"shutdown!",error_shutdown:"shutdown!",sys_owner:"reconnect",sys_nonowner:"idle!",sys_online:"ping",sys_offline:"idle!",sys_timetravel:"ping"}},s={state:new(b("ChatProxyConnectionState"))(),userActive:Date.now(),created:Date.now(),ready:!1,seqTurSentAt:-1,queueMade:"",sequenceId:0,lastPresenceState:null,lastRequestErrorReason:null,seq:0,pingFailuresOnSubdomain:0,pws:"fresh",estimatedReceived:0,sessionID:b("ChannelClientID").getID(),capabilities:b("PresenceProperties").getProperties(),streamingCapable:!1,inStreaming:!1,shouldSuppressPresence:b("cr:1167612")?b("cr:1167612").shouldSuppress():!1,LONGPOLL_TIMEOUT:6e4,STREAMING_TIMEOUT:6e4,P_TIMEOUT:3e4,IFRAME_LOAD_TIMEOUT:3e4,MIN_RETRY_INTERVAL:5e3,MAX_RETRY_INTERVAL:32e4,MIN_12002_TIMEOUT:9e3,MIN_504_TIMEOUT:2e4,STALL_THRESHOLD:18e4,JUMPSTART_THRESHOLD:9e4,MIN_INIT_PROBE_DELAY:3e3,INIT_PROBE_DELAY_RANDOMIZE_RANGE:12e3,CHANNEL_PROXY_REPORTING_MIN_INTERVAL:1e4,PROBE_DELAY:6e4,PROBE_HEARTBEATS_INTERVAL_LOW:1e3,PROBE_HEARTBEATS_INTERVAL_HIGH:5e3,STREAMING_EXIT_STATE_ON_CONTINUE:!1},t=1,u={},v=0;function w(){var a=b("AsyncRequest").lastSuccessTime;return a?Math.round((Date.now()-a)/1e3):-1}function x(a,b){return Object.prototype.hasOwnProperty.call(s,a)?s[a]:b}function y(){var a={};x("host")&&(a[x("user_channel")]=x("seq",0));return a}function z(a){a?(v=0,u={}):v++}c={state:"idle",nextState:null,proxyDown:!1,lastPullTime:Date.now(),lastReportOnMisguidedMsgTime:Date.now(),heartbeats:[],setTestCallback:a,backoff:!1,sessionRegistered:!1,_initTimer:null,_deferredTransition:null,_transportRate:null,_shutdownHint:null,init:function(a,c){var d=this;b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"initializing sessionid:%s at iris-seq:%s",s.sessionID,s.sequenceId);this.init=b("emptyFunction");b("Arbiter").subscribe(b("ChannelConstants").GET_RTI_SESSION_REQUEST,function(a,b){d.informCurrentSession()});b("Arbiter").subscribe(b("ChannelConstants").CONSOLE_LOG,function(a,b){});b("requestAnimationFrameAcrossTransitions")(function(){b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"using session id: %s at seq: %s {%s} with sticky: %s/%s",s.sessionID,s.seq,s.sequenceId,s.sticky_token,s.sticky_pool),b("UserActivity").subscribe(function(){var a=b("ChannelTransport").getURI(s,"/U");b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"user activity sessionid: %s at seq: %s/{%s} with sticky: %s/%s state: %s uri: %s",s.sessionID,s.seq,s.sequenceId,s.sticky_token,s.sticky_pool,d.state,a);d.state=="pull"&&(s.userActive=Date.now(),b("ChannelTransport").sendActivePing(s))}),b("Arbiter").subscribe(b("ChannelConstants").ENTITY_PRESENCE_ACTIVE_PING,function(a){a=b("ChannelTransport").getURI(s,"/U");b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"entity presence activity sessionid: %s at seq: %s/{%s} with sticky: %s/%s state: %s uri: %s",s.sessionID,s.seq,s.sequenceId,s.sticky_token,s.sticky_pool,d.state,a);d.state=="pull"&&(s.userActive=Date.now())})});b("PresenceCookieManager").register("ch",y);var e=this.getConfig("max_conn",2);s.subdomain=b("ChannelSubdomain").allocate(e);b("ChannelTransport").isSubdomain(s.subdomain)||(b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"invalid subdomain from ChannelSubdomain: %s",s.subdomain),s.subdomain=null);this._transportRate=new(b("MovingStat"))(3e4);var f=b("AjaxRequest").supportsCORS()?"CORSTransport":"IframeTransport";b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","transport_chosen."+f);this.transport=new(b("ChannelTransport")[f])(this);p(this.transport);a&&this.enterState(a,c);b("requestAnimationFrameAcrossTransitions")(function(){b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,b){d._transportRate&&(b.transportRate=d._transportRate.tally(),b.transportType=f,b.transportVersion=2)}),d._initMonitors()});if(this.getConfig("fullHost")&&b("AjaxRequest").supportsCORS()){if(this.getConfig("tryStreaming")){e=s.MIN_INIT_PROBE_DELAY+b("Random").random()*s.INIT_PROBE_DELAY_RANDOMIZE_RANGE;b("setTimeoutAcrossTransitions")(this._probeTest,e)}if(this.getConfig("trySSEStreaming")){a=s.MIN_INIT_PROBE_DELAY+b("Random").random()*s.INIT_PROBE_DELAY_RANDOMIZE_RANGE;b("setTimeoutAcrossTransitions")(this._sseProbeTest,a)}}},_mqttInit:function(){var a=this;b("FBMqttChannel").subscribe("/legacy_web",function(c){try{c=JSON.parse(c);a._processMqttMessage(c)}catch(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","mqttInit."+a.message)}})},configure:function(){for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];k.log("configure",JSON.stringify(c));c.forEach(function(a){return Object.assign(s,a)});this._indicateLbInfoUpdated("reconnect",JSON.stringify(c));b("Arbiter").inform(b("ChannelConstants").ON_CONFIG,this)},getConfig:function(a,b){return x(a,b)},getCompleteConfig:function(){return s},subscribeIrisQueue:function(a,c){s.state.subscribeIrisQueue(a,c),this.exitState({status:b("ChannelConstants").OK,stateId:t})},unsubscribeIrisQueue:function(a){s.state.unsubscribeIrisQueue(a)},informCurrentSession:function(){var a=null;this.sessionRegistered&&s&&s.fullHost&&s.sticky_token&&s.uid&&(a=new(b("RTISession"))(s.fullHost,s.domain,s.port,s.sticky_pool,s.sticky_token,s.uid,s.viewerUid,s.profile,s.sessionID,s.capabilities));b("Arbiter").inform(b("ChannelConstants").RTI_SESSION,a)},isShutdown:function(){return this.state=="shutdown"},shouldIdle:function(){return!(b("SystemEvents").isPageOwner()&&b("SystemEvents").isOnline())},_sendIframeError:function(a){a=new(b("AsyncRequest"))().setURI("/ajax/presence/reconnect.php").setData({reason:a,fb_dtsg:b("DTSG").getToken()}).setOption("suppressErrorHandlerWarning",!0).setOption("retries",1).setMethod("GET").setReadOnly(!0).setAllowCrossPageTransition(!0);a.specifiesWriteRequiredParams()&&a.send()},_getDelay:function(){var a=Math.min(s.MIN_RETRY_INTERVAL*Math.pow(2,Math.max(0,v-1)),s.MAX_RETRY_INTERVAL);this.proxyDown&&"proxy_down_delay_millis"in s&&(a=s.proxy_down_delay_millis);this.proxyDown=!1;return Math.floor(a*(1+Math.random()*.5))},resetDelay:function(){z(!0)},enterState:function(a,c){this._inEnterState&&(k.warn("enterstate_recursion",JSON.stringify({state:this.state,args:arguments})),b("ChatReliabilityInstrumentation").logERROR("enterstate_recursion"));this._inEnterState=!0;try{this._enterState.apply(this,arguments),this._inEnterState=!1}catch(a){this._inEnterState=!1;throw a}},_enterState:function(a){var c=this;if(n&&!(/init/.test(a)||/reconnect/.test(a)))return;var d=this.backoff?this._getDelay():0;this.backoff=!1;if(this.isShutdown()){b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"not executing state due to shutdown mode: %s",a);return}if(a!="idle!"&&this.shouldIdle()){b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"forced idleness");return}t++;s.stateId=t;b("clearTimeout")(this._deferredTransition);this._deferredTransition=null;!this.transport?(q.then(function(a){return a.enterState("idle")}),b("ChatReliabilityInstrumentation").logERROR("called enterState "+a+" before transport init")):this.transport.enterState("idle");this.state="idle";this.nextState=null;if(/!$/.test(a)){if(this._transportRate){var e=this._transportRate.tally().timeAverage,f=this.getConfig("MAX_CHANNEL_STATES_PER_SEC",1);e>=f&&(this._throttled||(this._throttled=!0,k.warn("throttled","{}"),b("Arbiter").inform(b("ChannelConstants").THROTTLED,e)),j.bump("throttle"),d=1e3/f)}}else/#$/.test(a)||(d=this._getDelay());a=a.replace(/\W*$/,"");if(!r[a]){b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"invalid state: %s",a);throw new Error("invalid state:"+a)}var g=Array.from(arguments),h={};if(d<=0){h.state=a;this._transportRate&&this._transportRate.add(1);this.state=a;var i=this["_enter_"+this.state];i&&(g.shift(),i.apply(this,g));/init|idle|pull|ping/.test(this.state)&&(s.streamingCapable&&/pull/.test(this.state)&&(this.heartbeats=[]),s.is_offline=!b("ChatVisibility").isOnline(),s.capabilities=b("PresenceProperties").getProperties(),b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"entering transport state: %s",this.state),!this.transport?(q.then(function(a){return a.enterState(c.state,s)}),b("ChatReliabilityInstrumentation").logERROR("called enterState "+a+" before transport init")):this.transport.enterState(this.state,s),this.state=="ping"&&(h.url=b("ChannelTransport").getURI(s).toString(),h.port=s.port||"undefined"))}else this.state="idle",this.nextState=a,h.state=this.state,h.delay=d,h.nextState=a,g[0]=a+"#",this._deferredTransition=b("setTimeoutAcrossTransitions")(function(){c._deferredTransition=null,c.enterState.apply(c,g)},d);/pull/.test(a)&&(h.client_id=s.sessionID,h.streaming=s.inStreaming);b("Arbiter").inform(b("ChannelConstants").ON_ENTER_STATE,h)},exitState:function(a,c){var d=a.stateId,e=a.status;if(this.isShutdown()||d<t)return;var f=this.state,g=Array.from(arguments);g[0]=a.status;var h={};h.state=f;h.status=e;/pull/.test(f)&&(h.client_id=s.sessionID,h.streaming=s.inStreaming);/ping/.test(f)&&e!=b("ChannelConstants").OK&&(h.url=b("ChannelTransport").getURI(s).toString());this.nextState&&(h.nextState=this.nextState);c&&c.errorType?(s.lastRequestErrorReason=c.errorType,h.xhr=c.toJSON?c.toJSON():c,c.errorType==b("AjaxError").SERVICE_UNAVAILABLE&&(b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"got 5xx http status code, setting long delay"),this.proxyDown=!0),delete h.xhr.json):e!=b("ChannelConstants").OK&&(s.lastRequestErrorReason=e);c&&c.json&&(c.json.t&&(h.t=c.json.t),c.json.reason&&(h.reason=c.json.reason),c.json.seq&&(h.seq=c.json.seq));b("Arbiter").inform(b("ChannelConstants").ON_EXIT_STATE,h);var i=this["_exit_"+f];i&&(e=i.apply(this,g)||e);e!=b("ChannelConstants").OK&&(z(),u[f]=(u[f]||0)+1);var j=r[this.nextState||f][e]||r._all[e],l=j&&j.replace(/!*$/,"");l||(k.error("terminal_transition",JSON.stringify(h)),this._shutdownHint=b("ChannelConstants").HINT_INVALID_STATE,j="shutdown!",b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"entering shutdown state"));this._lastState=f;this._lastStatus=e;this.enterState(j)},_processTransportData:function(a,b){this._processTransportData0(a,b,b.json)},_processTransportData0:function(a,c,d){var e=d.t;"s"in d&&(d.seq=d.s,delete d.s);if(d.u&&s.user&&d.u!=s.user){k.warn("misguided_msg",JSON.stringify({user:s.user,target:d.u}));this._reportProxyMisguidedMsg(d.u,s.user);return}var f=s.seq;"seq"in d&&(s.seq=d.seq,b("cr:1167612")&&b("cr:1167612").doSync());switch(e){case"continue":s.inStreaming&&this.heartbeats.length<1&&(s.streamingCapable=!1,k.log("switch_to_longpoll","{}"),b("setTimeoutAcrossTransitions")(this._probeTest,s.PROBE_DELAY));z(!0);(!s.inStreaming||s.STREAMING_EXIT_STATE_ON_CONTINUE)&&this.exitState({status:b("ChannelConstants").OK,stateId:a});break;case"refresh":case"refreshDelay":b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"got refresh with reason: %s",d.reason);this.exitState({status:"refresh_"+(d.reason||0),stateId:a},c);break;case"backoff":b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"server told client to back off");z();this.backoff=!0;break;case"lb":var g=d.lb_info;if(g){s.sticky_token=g.sticky;"pool"in g&&(s.sticky_pool=g.pool);if("sd"in g){var h=g.subdomain;b("ChannelTransport").isSubdomain(h)&&(s.subdomain=g.subdomain)}"vip"in g&&(s.host=g.vip);this._indicateLbInfoUpdated("chatproxy",JSON.stringify(d))}else k.error("missing_lb_info","{}");break;case"test_streaming":b("setTimeoutAcrossTransitions")(this._probeTest,500);break;case"fullReload":b("PresenceCookieManager").clear();k.log("full_reload","{}");this.sessionRegistered=!0;this.informCurrentSession();b("Arbiter").inform(b("ChannelConstants").ON_INVALID_HISTORY);z(!0);b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"full reload incurred");h=b("ChannelConstants").OK;this.exitState({status:h,stateId:a},c);"ms"in d&&this._processMessages(d,f);break;case"msg":z(!0);this._processMessages(d,f);break;case"heartbeat":if(s.inStreaming){g=Date.now();var i;this.heartbeats.length>0&&(i=g-this.heartbeats[this.heartbeats.length-1]);k.log("heartbeat_interval",JSON.stringify({client_id:s.sessionID,interval:i}));this.heartbeats.push(g)}break;case"batched":h=d.batches;for(var f=0;f<h.length;f++)this._processTransportData0(a,c,h[f]);break;default:b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"got an unknown protocol message: %s",e);k.error("unknown_msg_type",JSON.stringify({type:e}));break}},_processMqttMessage:function(a){if(b("DesktopWebMessageTypesSitevarConfig").ChatProxySupportedMessageTypes.get(a.type)===!0&&b("DesktopWebMessageTypesSitevarConfig").MQTTMigrationExcludeMessageTypes.get(a.type)!==!0)if(a.type==="rtc_live_json"&&!l)b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMqttMessages.dropped."+a.type);else{var c=b("ChannelConstants").getArbiterType(a.type);b("Arbiter").inform(c,{obj:a});b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMqttMessages."+a.type)}else b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMqttMessages.dropped."+a.type)},_processMessages:function(a,c){"tr"in a&&(s.trace_id=a.tr);a=a.ms;var d=s.seq-a.length;for(var e=0;e<a.length;e++,d++){s.estimatedReceived++;if(d>=c){var f=a[e];if(f.type){b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","messageReceive."+f.type);if(b("DesktopWebMessageTypesSitevarConfig").ChatProxySupportedMessageTypes.get(f.type)!==!0){b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMessages.dropped."+f.type);continue}var g=b("ChannelConstants").getArbiterType(f.type);f.type==="skywalker"?g=b("ChannelConstants").SKYWALKER:f.type==="qprimer"?m||(f.first=!s.ready,f.first&&(s.ready=!0,s.timeUntilReady=Date.now()-s.created,s.queueMade=f.made),g=b("ChannelConstants").CHANNEL_ESTABLISHED):f.type==="delta"&&(s.sequenceId=f.iseq);try{f.type=="buddylist_overlay"&&f.buffered==1?b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMessages.buddylist_overlay.dropped"):b("DesktopWebMessageTypesSitevarConfig").MQTTMigrationExcludeMessageTypes.get(f.type)!==!0?f.type==="rtc_live_json"&&!l?b("Arbiter").inform(g,{obj:f}):b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMessages.migration.list."+f.type):b("Arbiter").inform(g,{obj:f})}catch(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMessages.error."+f.type),b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"message threw exception: %s %s",a,f)}}}else k.warn("seq_regression",JSON.stringify({last_seq:c,messages:a.length,seq:d}))}},_enter_init:function(){var a=this;if(u.init>=this.getConfig("MAX_INIT_FAILS",2))return b("setTimeoutAcrossTransitions")(function(){return a.exitState({status:b("ChannelConstants").ERROR_MAX,stateId:t})},0);this._initTimer=b("setTimeoutAcrossTransitions")(function(){return a.exitState({status:b("ChannelConstants").ERROR,stateId:t},"timeout")},s.IFRAME_LOAD_TIMEOUT)},_enter_reconnect:function(a){var c=this;k.warn("enter_reconnect",a);b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"entered reconnect with reason: %s",a);var d=t;if(!b("PresenceUtil").hasUserCookie()){b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"user has no cookie???");k.warn("no_user_cookie","{}");b("setTimeoutAcrossTransitions")(function(){c._shutdownHint=b("ChannelConstants").HINT_AUTH,c.exitState({status:b("ChannelConstants").ERROR_SHUTDOWN,stateId:d})},0);return}var e={};e.reason=a;e.fb_dtsg=b("DTSG").getToken();b("ISB").token&&(e.fb_isb=b("ISB").token);o&&o(e);var f=new(b("FBAjaxRequest"))("GET","/ajax/presence/reconnect.php",e);f.onSuccess=function(){c.configure(f.json),b("PresenceCookieManager").store(),c.exitState({status:b("ChannelConstants").OK,stateId:d})};f.onError=function(){var a=f.json&&f.json.error;b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"reconnect error: %s",f.errorType);(f.errorType==b("AjaxError").TRANSPORT_ERROR||f.errorType==b("AjaxError").PROXY_ERROR||f.errorType==b("AjaxError").SERVICE_UNAVAILABLE)&&(c._shutdownHint=b("ChannelConstants").HINT_CONN);a&&a==1356007?c._shutdownHint=b("ChannelConstants").HINT_MAINT:a==1357001||a==1357004||a==1348009?c._shutdownHint=b("ChannelConstants").HINT_AUTH:c._shutdownHint=null;c.exitState({status:c._shutdownHint?b("ChannelConstants").ERROR_SHUTDOWN:b("ChannelConstants").ERROR,stateId:d},f)};!n?f.send():f.onSuccess()},_enter_shutdown:function(){var a=this;b("Arbiter").inform(b("ChannelConstants").ON_SHUTDOWN,{reason:this._shutdownHint});if("shutdown_recovery_interval_seconds"in s&&s.shutdown_recovery_interval_seconds>0){var c=s.shutdown_recovery_interval_seconds*1e3;b("setTimeoutAcrossTransitions")(function(){b("Arbiter").inform(b("ChannelConstants").ATTEMPT_RECONNECT),a._shutdownHint=null,a.state="reconnect!",a.enterState("reconnect!")},c)}},_exit_init:function(a){this._initTimer&&(this._initTimer=b("clearTimeout")(this._initTimer)),a==b("ChannelConstants").ERROR_MAX&&this._sendIframeError(b("ChannelConstants").reason_IFrameLoadGiveUp)},_exit_pull:function(a,c){if(a===b("ChannelConstants").OK){this.lastPullTime=Date.now();return}a="exit status: "+a;c&&c.errorType&&(a+=" ajax request error: "+c.errorType);b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"pull failed with status: %s",a)},_exit_ping:function(a){if(a!==b("ChannelConstants").OK){b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"ping failed with status: %s",a);return}a=Date.now()-(this.lastPullTime||(h||(h=b("Env"))).start);if(a>s.STALL_THRESHOLD){b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"didnt complete a successful pull for too long");return b("ChannelConstants").ERROR_STALE}},_reportProxyMisguidedMsg:function(a,c){b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"misguided message to %s meant for %s",c,a);var d=Date.now();if(d-this.lastReportOnMisguidedMsgTime<=s.CHANNEL_PROXY_REPORTING_MIN_INTERVAL)return;this.lastReportOnMisguidedMsgTime=d;d={};d.received_uid=a;d.expected_uid=c;s.sticky_token&&(d.sticky_token=s.sticky_token);a=new(i||(i=b("URI")))("/err_misguided_msg").setDomain(s.host+"."+s.domain).setPort(s.port).setSecure(new i(window.location.href).isSecure()).setQueryData(d);c=new(b("AjaxRequest"))("GET",a);b("AjaxRequest").supportsCORS()&&(c.xhr.withCredentials=!0);c.onSuccess=function(a){};c.onError=function(a){};c.onJSON=function(a){};c.send()},_initMonitors:function(){var a=this,c,d=Date.now(),e=Date.now(),f={};f.total=0;var g="idle",i=!1;(c=b("SystemEvents")).subscribe([c.USER,c.ONLINE,c.TIME_TRAVEL],function(c,d){z(!0);e=null;a.lastPullTime=Date.now();var f;switch(c){case b("SystemEvents").USER:f=b("SystemEvents").isPageOwner()?b("ChannelConstants").SYS_OWNER:b("ChannelConstants").SYS_NONOWNER;break;case b("SystemEvents").ONLINE:f=d?b("ChannelConstants").SYS_ONLINE:b("ChannelConstants").SYS_OFFLINE;break;case b("SystemEvents").TIME_TRAVEL:if(s.skipTimeTravel)return;if(0<d){b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"skipping time travel failure. %s",d);return}f=b("ChannelConstants").SYS_TIMETRAVEL;break}a.exitState({status:f,stateId:t})});c=function(a,c){var h=Date.now(),i=null;c?(d=h,i=c.nextState||c.state):i=g;b("SystemEvents").checkTimeTravel();if(e){c=Math.round((h-e)/1e3);c>0&&(f[g]=(f[g]||0)+c,f.total+=c)}g=i;e=h;a||(f.lastSuccessTime=w(),f.online=b("SystemEvents").isOnline(),k.log("rollup",JSON.stringify(f)))};b("Arbiter").subscribe(b("ChannelConstants").ON_ENTER_STATE,c);b("setIntervalAcrossTransitions")(c,6e4);b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,b){b.channelRollup=f});c=function(){if(a.isShutdown()||a.shouldIdle())return;b("SystemEvents").checkTimeTravel();var c=Date.now()-(a.lastPullTime||(h||(h=b("Env"))).start);if(!i&&c>s.STALL_THRESHOLD){var e=w();k.error("stall",JSON.stringify({lastSuccessTime:e,rollupState:g}));b("ChatReliabilityInstrumentation").logCHANNEL_STALLED(c.toString());i=!0}e=Date.now()-(d||0);a.state=="pull"&&e>s.JUMPSTART_THRESHOLD&&(d=null,k.warn("jumpstart",JSON.stringify({state:a.state,dormant:e})),b("Arbiter").inform(b("ChannelConstants").JUMPSTART,e),a.enterState("init"))};b("setIntervalAcrossTransitions")(c,5e3)},_indicateLbInfoUpdated:function(a,c){var d=!b("AjaxRequest").supportsCORS(),e=b("ChannelTransport").isSubdomain(s.subdomain);!e||d?s.fullHost=s.host:s.fullHost=s.subdomain+"-"+s.host;b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"received lb info: %s at seq: %s{%s} with ".concat("sticky: %s/%s, subdomain: %s, fullHost: %s, state: %s,").concat(" source: %s, args: %s"),s.sessionID,s.seq,s.sequenceId,s.sticky_token,s.sticky_pool,s.subdomain,s.fullHost,this.state,a,c)},_probeTest:function(){s.streamingCapable=!1;var a=[],c={};c.mode="stream";c.format="json";s.sticky_token&&(c.sticky_token=s.sticky_token);c=new(i||(i=b("URI")))("/probe").setDomain(s.fullHost+"."+s.domain).setPort(s.port).setSecure(new i(window.location.href).isSecure()).setQueryData(c);b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","probe.attempt");c=new(b("AjaxRequest"))("GET",c);c.onJSON=function(c,d){if(c&&c.json&&c.json.t==="heartbeat"){a.push(Date.now());if(a.length>=2){d=a[1]-a[0];d>=s.PROBE_HEARTBEATS_INTERVAL_LOW&&d<=s.PROBE_HEARTBEATS_INTERVAL_HIGH?(s.streamingCapable=!0,b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","probe.switch_to_streaming"),k.log("switch_to_streaming","{}")):b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","probe.failure.delayed")}}};c.onSuccess=function(c){a.length!=2&&(s.streamingCapable=!1,b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","probe.failure.data_loss"),k.error("probe_error",JSON.stringify({error:"beats.length = "+a.length}))),b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","probe.success"),k.log("probe_success","{}")};c.onError=function(a){s.streamingCapable=!1,b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","probe.failure.error"),k.error("probe_error",JSON.stringify(a))};c.send()},_sseProbeTest:function(){if(!window.EventSource){b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","sse_probe.failure.no_event_source");k.log("sse_probe.failure.no_event_source","{}");return}var a=[],c={};c.mode="sse";c.format="json";s.sticky_token&&(c.sticky_token=s.sticky_token);c=new(i||(i=b("URI")))("/sse_probe").setDomain(s.fullHost+"."+s.domain).setPort(s.port).setSecure(new i(window.location.href).isSecure()).setQueryData(c);b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","sse_probe.attempt");var d=new EventSource(c.toString()),e=b("setTimeoutAcrossTransitions")(function(){d.close(),b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","sse_probe.failure.timeout"),k.log("sse_probe.failure.timeout","{}")},s.PROBE_HEARTBEATS_INTERVAL_HIGH*6);d.addEventListener("heartbeat",function(c){a.push(Date.now());if(a.length>=2){c=a[1]-a[0];c>=s.PROBE_HEARTBEATS_INTERVAL_LOW&&c<=s.PROBE_HEARTBEATS_INTERVAL_HIGH?(b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","sse_probe.success"),k.log("sse_probe.success","{}")):(b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","sse_probe.failure.delayed"),k.log("sse_probe.failure.delayed","{}"));b("clearTimeout")(e);d.close()}});d.onerror=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","sse_probe.failure.error"),k.error("sse_probe.failure.error",JSON.stringify(a)),b("clearTimeout")(e),d.close()}},startChannelManagerForApp:function(a){this.startChannelManager!==b("emptyFunction")&&this.startChannelManager(),b("ChannelInitialData").channelConfig&&s&&(s.profile=a)},startChannelManager:function(){b("ChannelInitialData").channelConfig?(this.configure(b("ChannelInitialData").channelConfig),/shutdown/.test(b("ChannelInitialData").state)&&(this._shutdownHint=b("ChannelConstants")[b("ChannelInitialData").reason]),this.init(b("ChannelInitialData").state,b("ChannelInitialData").reason),this._mqttInit(),b("ChatReliabilityInstrumentation").logCHANNEL_INIT(),this.startChannelManager=b("emptyFunction")):b("ChatReliabilityInstrumentation").logCHANNEL_NOCONFIG()}};e.exports=c},null);
__d("FBRTCConsoleLogger",["nullthrows","requireCond","Log","LogHistory","cr:1112656"],function(a,b,c,d,e,f){"use strict";var g=null;a=function(){a.getInstance=function(){g||(g=new a());return g};function a(){this.$1=b("LogHistory").getInstance(a.MODULE_NAME)}var c=a.prototype;c.getLogHistory=function(){return this.$1};c.log=function(a,b,c,d,e){d===void 0&&(d="Console");e===void 0&&(e="DEBUG");e=" "+JSON.stringify({conferenceName:b,callID:c});this.$1.log(d||"Console",a+e);return this};return a}();a.MODULE_NAME="webrtc";e.exports=a},null);
__d("FBRTCConstants",["keyMirror"],function(a,b,c,d,e,f){a=Object.freeze({OFFER:"offer",ANSWER:"answer",ICE_CANDIDATE:"ice_candidate",OK:"ok",PING:"ping",PING_ACK:"ping_ack",HANGUP:"hang_up",OTHER_DISMISS:"other_dismiss",MSG_ACK:"msg_ack",PRANSWER:"pranswer",ICERESTART_OFFER:"icerestart_offer",ICERESTART_ANSWER:"icerestart_answer",PCRESTART_OFFER:"pcrestart_offer",PCRESTART_ANSWER:"pcrestart_answer",SDP_UPDATE:"sdp_update",OFFER_ACK:"offer_ack",OFFER_NACK:"offer_nack",ANSWER_ACK:"answer_ack",SET_VIDEO:"set_video",VIDEO_REQUEST:"video_request",ACK:"ack",SWITCH_TO_MULTIWAY:"switch_to_multiway",CLIENT_REPORTED_EVENT:"client_reported_event"});c=Object.freeze({CHILD_WINDOW_READY:"rtc_child_window_ready",CHILD_WINDOW_START_CALL:"rtc_child_window_start_call",CHILD_WINDOW_MESSAGE:"rtc_child_window_message"});d=Object.freeze({DIRECT_VIDEO:"direct_video",ESCALATED:"escalated",ESCALATION_DECLINED:"escalation_declined",VOIP:"voip"});f=b("keyMirror")({SCREEN:null,CAMERA:null});var g=Object.freeze({LL_NONE:0,LL_BASIC:1,LL_DEBUG:2,LL_WARNING:3,LL_INFO:4,LL_VERBOSE:5}),h=Object.freeze({AUDIO_ONLY:"audio_only",AUDIO_VIDEO:"audio_video",SCREEN_CONTENT:"screen"}),i=Object.freeze({CUSTOM_VIDEO_STREAM_SIZE:"CUSTOM_VIDEO_STREAM_SIZE",CUSTOM_VIDEO:"CUSTOM_VIDEO",FHD_VIDEO:"FHD_VIDEO",HD_VIDEO:"HD_VIDEO",LQ_VIDEO:"LQ_VIDEO",SD_VIDEO:"SD_VIDEO",HD_IDEAL_LQ_REQUIRED_VIDEO:"HD_IDEAL_LQ_REQUIRED_VIDEO",FHD_IDEAL_LQ_REQUIRED_VIDEO:"FHD_IDEAL_LQ_REQUIRED_VIDEO"}),j=Object.freeze({FHD_HEIGHT:1080,HD_HEIGHT:720,LQ_HEIGHT:180,SD_HEIGHT:480,FHD_WIDTH:1920,HD_WIDTH:1280,LQ_WIDTH:320,SD_WIDTH:848,VLQ_FRAME_RATE:5,LQ_FRAME_RATE:15,FRAME_RATE:30}),k=Object.freeze({UNKNOWN:-1,IGNORE_CALL:0,HANGUP_CALL:1,IN_ANOTHER_CALL:2,ACCEPT_AFTER_HANGUP:3,NO_ANSWER_TIMEOUT:4,INCOMING_TIMEOUT:5,OTHER_INSTANCE_HANDLED:6,SIGNALING_MESSAGE_FAILED:7,CONNECTION_DROPPED:8,CLIENT_INTERRUPTED:9,WEBRTC_ERROR:10,CLIENT_ERROR:11,NO_PERMISSION:12,OTHER_NOT_CAPABLE:13,NO_UI_ERROR:14,UNSUPPORTED_VERSION:15,CALLER_NOT_VISIBLE:16,CARRIER_BLOCKED:17,OTHER_CARRIER_BLOCKED:18,CLIENT_ENCRYPTION_ERROR:19,INACTIVE_TIMEOUT:20,KILLED:21}),l=["IgnoreCall","HangupCall","InAnotherCall","CallEndAcceptAfterHangUp","NoAnswerTimeout","IncomingTimeout","OtherInstanceHandled","SignalingMessageFailed","ConnectionDropped","ClientInterrupted","WebRTCError","ClientError","NoPermission","OtherNotCapable","NoUIShown","VersionUnsupported","CallerNotVisible","CarrierBlocked","OtherCarrierBlocked","ClientEncryptionError","InactiveTimeout","Killed"],m=Object.freeze({CALL_INITIALIZATION_FAILED:"CollabCallInitializationFailed",CLOSED_AS_STALE:"CollabClosedAsStale",CLOSED_BY_MCU:"CollabClosedByMcu",INVALID_MEETING_ID:"CollabInvalidMeetingId",LOST_MCU_CONNECTION:"CollabLostMcuConnection",LOST_MCU_THRIFT_CONNECTION:"CollabLostMcuThriftConnection",LOST_SIP_ADAPTER_CONNECTION:"CollabLostSipAdapterConnection",MCU_INVALID_STREAM_CONFIGURATION:"CollabMcuInvalidStreamConfiguration",MCU_NO_AUDIO_STREAM:"CollabMcuNoAudioStream",REMOTE_PEER_HANGUP:"CollabRemotePeerHangup",REMOTE_PEER_REJECT:"CollabRemotePeerReject",SIP_CONNECTION_INITIALIZATION_FAILED:"CollabSipConnectionInitializationFailed",AUDIO_ONLY_DISALLOWED:"CollabAudioOnlyDisallowed",UNKNOWN:"CollabUnknown",KILLED_VIA_THRIFT_API:"CollabKilledViaThriftApi"}),n=Object.freeze({TOGGLE_SELF_VIEW:5,SUBMIT_STAR_RATING:6,SUBMIT_FEEDBACK:7,START_CALL:9,OPEN_SCREEN_IN_NEW:10}),o=Object.freeze({ONE_HOUR:"1hour",UNTIL_EIGHT_AM:"8am",ALWAYS:"always"});b=b("keyMirror")({AUDIO:null,VIDEO:null});var p=Object.freeze({CUSTOM:"custom",MULTIWAY:"multiway",P2P:"p2p"}),q=Object.freeze({DOMINANT_SPEAKER:"DOMINANT_SPEAKER",GRID:"GRID"}),r=Object.freeze({LANDSCAPE:"LANDSCAPE",PORTRAIT:"PORTRAIT"}),s=Object.freeze({UNKNOWN:0,MEDIA_CONNECTED:1}),t=Object.freeze({PLAN_B:"plan-b",UNIFIED_PLAN:"unified-plan"});o={CallBlockingConstants:o,CallEndReason:k,CallType:d,ChildWindowMessageType:c,CollabCallEndSubreason:m,GroupVideoViewLayout:q,IncomingCallDialogTypes:b,Orientation:r,PayloadType:a,RTCConstraints:j,SDPSemantics:t,SignalingProtocol:p,StreamType:h,UIEventType:n,UploadLogLevel:g,VideoQuality:i,MediaContentTypes:f,ClientReportedEventType:s,convertFromUploadLogLevel:function(a){switch(a){case g.LL_DEBUG:return"d";case g.LL_BASIC:return"b";case g.LL_WARNING:return"w";case g.LL_INFO:return"i";case g.LL_VERBOSE:return"v";case g.LL_NONE:default:return null}},convertToUploadLogLevel:function(a){switch(a){case"d":return g.LL_DEBUG;case"b":return g.LL_BASIC;case"w":return g.LL_WARNING;case"i":return g.LL_INFO;case"v":return g.LL_VERBOSE;default:return g.LL_NONE}},uploadLogLevelString:function(a){switch(a){case g.LL_BASIC:return"basic";case g.LL_DEBUG:return"debug";case g.LL_WARNING:return"warning";case g.LL_INFO:return"info";case g.LL_VERBOSE:return"verbose";default:return""}},endCallReasonFromString:function(a){return l.indexOf(a)},callEndReasonString:function(a){a=l[a];return!a?"Unknown":a},fullCallEndReasonString:function(a,b){return this.callEndReasonString(a)+"_"+(b?"remote":"local")}};e.exports=o},null);
__d("RTWebExperiments",["FBRTCConfig","qex"],function(a,b,c,d,e,f){"use strict";a={enableCallCollisionFix:function(){return b("FBRTCConfig").isVCEndpointCall()?!1:b("qex")._("771668")},passOfferWithWindowMessages:function(){return b("FBRTCConfig").isVCEndpointCall()?!1:b("qex")._("771669")}};e.exports=a},null);
__d("FBRTCLocalMessageQueue",["CacheStorage","FBRTCConstants","RTWebExperiments"],function(a,b,c,d,e,f){var g="localstorage",h="RTC_",i="offer",j="offer_msg",k="data_",l=30*1e3,m=new Map(),n={STORAGE_TYPE:g,PREFIX:h,OFFER_KEY:i,OFFER_SUFFIX:j,DATA_KEY_PREFIX:k,CACHE_LIFE:l,clearQueue:function(a){m.set(a,new Map())},writePeerOfferToStorage:function(a,b){a=n.getStorage(a,j);n._storeData(a,i,b)},getPeerOfferFromStorage:function(a){a=n.getStorage(a,j);return n._getData(a,i)},clearPeerOfferFromStorage:function(a){a=n.getStorage(a,j);a.remove(i)},pluckOffer:function(a){if(b("RTWebExperiments").passOfferWithWindowMessages()){var c=m.get(a)||new Map(),d=c.get(i);c["delete"](i);return d||null}else{c=n.getPeerOfferFromStorage(a);n.clearPeerOfferFromStorage(a);return c||null}},enqueueMessage:function(a,c,d){c=k+c.toString();var e=m.get(a)||new Map();d.msg_type===b("FBRTCConstants").PayloadType.OFFER&&(c=i);e.set(c,d);m.set(a,e)},drainQueue:function(a,b){var c=m.get(a)||new Map();for(var c=c,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;f[0];f=f[1];b(f)}m.set(a,new Map())},_storeData:function(a,b,c){c={__t:Date.now(),__d:c};a.set(b,c)},_getData:function(a,b){var c=a.get(b);if(c&&n._isValid(c))return c.__d;else c&&a.remove(b);return null},_getAndRemoveData:function(a,b){var c=n._getData(a,b);if(c!==null){a.remove(b);return c}return null},_isValid:function(a){return Date.now()-a.__t<l},getStorage:function(a,c){return new(b("CacheStorage"))(g,""+h+a+"_"+c+"_")}};e.exports=n},null);
__d("P2PReliabilityTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:P2PReliabilityLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:P2PReliabilityLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:P2PReliabilityLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setAppBuildNumber=function(a){this.$1.app_build_number=a;return this};c.setAppID=function(a){this.$1.app_id=a;return this};c.setAppVersion=function(a){this.$1.app_version=a;return this};c.setCallID=function(a){this.$1.call_id=a;return this};c.setClientStackInfo=function(a){this.$1.client_stack_info=a;return this};c.setDeviceID=function(a){this.$1.device_id=a;return this};c.setEventName=function(a){this.$1.event_name=a;return this};c.setExtra=function(a){this.$1.extra=a;return this};c.setMsgID=function(a){this.$1.msg_id=a;return this};c.setMsgType=function(a){this.$1.msg_type=a;return this};c.setProcessingTimeSinceRecvOnWww=function(a){this.$1.processing_time_since_recv_on_www=a;return this};c.setRawTime=function(a){this.$1.raw_time=a;return this};c.setReceiverID=function(a){this.$1.receiver_id=a;return this};c.setResultCode=function(a){this.$1.result_code=a;return this};c.setSenderID=function(a){this.$1.sender_id=a;return this};c.setServiceName=function(a){this.$1.service_name=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setUserCountry=function(a){this.$1.user_country=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};return a}();c={app_build_number:!0,app_id:!0,app_version:!0,call_id:!0,client_stack_info:!0,device_id:!0,event_name:!0,extra:!0,msg_id:!0,msg_type:!0,processing_time_since_recv_on_www:!0,raw_time:!0,receiver_id:!0,result_code:!0,sender_id:!0,service_name:!0,time:!0,user_country:!0,weight:!0};e.exports=a},null);
__d("RTWebLoggingSharedInstance",["ChannelClientID"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=b("ChannelClientID").getID()}var c=a.prototype;c.getDeviceID=function(){return this.$1};return a}();e.exports=new a()},null);
__d("FBRTCLogger",["ChannelClientID","FBLogger","FBRTCConsoleLogger","FBRTCMessageType","MarauderLogger","P2PReliabilityTypedLogger","RTWebLoggingSharedInstance","UserAgentData","CurrentUser","pageID"],function(a,b,c,d,e,f){var g=b("CurrentUser").getID(),h="call_action",i="rtc_client_call_summary",j="client_error",k="client_event",l="info",m="received_message",n="send_failed",o="send_succeeded",p="sent_message",q="rtc_tslog",r=null;a=function(){"use strict";a.getInstance=function(){r==null&&(r=new a());return r};a.multiwayMessageTypeName=function(a){switch(a){case b("FBRTCMessageType").JOIN:return"JOIN";case b("FBRTCMessageType").SERVER_MEDIA_UPDATE:return"SERVER_MEDIA_UPDATE";case b("FBRTCMessageType").HANGUP:return"HANGUP";case b("FBRTCMessageType").ICE_CANDIDATE:return"ICE_CANDIDATE";case b("FBRTCMessageType").RING:return"RING";case b("FBRTCMessageType").DISMISS:return"DISMISS";case b("FBRTCMessageType").CONFERENCE_STATE:return"CONFERENCE_STATE";case b("FBRTCMessageType").ADD_PARTICIPANTS:return"ADD_PARTICIPANTS";case b("FBRTCMessageType").SUBSCRIPTION:return"SUBSCRIPTION";case b("FBRTCMessageType").CLIENT_MEDIA_UPDATE:return"CLIENT_MEDIA_UPDATE";case b("FBRTCMessageType").DATA_MESSAGE:return"DATA_MESSAGE";case b("FBRTCMessageType").REMOVE_PARTICIPANTS:return"REMOVE_PARTICIPANTS";case b("FBRTCMessageType").EXPERIMENT:return"EXPERIMENT";case b("FBRTCMessageType").CONNECT:return"CONNECT";case b("FBRTCMessageType").APPROVAL:return"APPROVAL"}return a.toString()};function a(){var a;this.$2=JSON.stringify({version:2,device:(a=b("UserAgentData")).deviceName,os:a.platformName,os_version:a.platformFullVersion,browser:a.browserName,browser_version:a.browserFullVersion});this.$3=JSON.stringify({version:2,device:a.deviceName,os:a.platformName,os_version:a.platformFullVersion,browser:a.browserName,browser_version:a.browserFullVersion,msg_source:"web"});this.$1=b("RTWebLoggingSharedInstance").getDeviceID()}var c=a.prototype;c.logToConsole=function(a){this.$4(null,null,"Console",a)};c.$5=function(a){return new(b("P2PReliabilityTypedLogger"))().setExtra(this.$2).setDeviceID(this.$1).setRawTime(Date.now()).setServiceName("WEB_CLIENT").setMsgType(a.toUpperCase())};c.logMultiwayMessageReceived=function(b,c){var d=a.multiwayMessageTypeName(b.type());this.$4(b.conferenceName(),c,"Received MW",d+", "+b.transactionId(),d==="EXPERIMENT"?"DEBUG":"INFO")};c.logReceivedMessage=function(a,b,c){var d=b?b.toString():null,e={call_id:b,from:a,msg_id:c.msg_id,type:c.type};c.sdp&&(e.content=c.sdp);c.ack_id&&(e.ack_msg_id=c.ack_id);var f=c.type||c.msgType;this.$5(f).setEventName("CLIENT_RECEIVED_MESSAGE").setCallID(d).setMsgID(c.msg_id).setSenderID(a).setReceiverID(g).setExtra(this.$3).log();this.$6(m,e);this.$4(a,b,"Received P2P",c.type+", "+c.msg_id)};c.logSentMessage=function(a,b,c){var d=b?b.toString():null,e={call_id:b,msg_id:c.msg_id,to:a,type:c.type};c.sdp&&(e.content=c.sdp);c.ack_id&&(e.ack_msg_id=c.ack_id);this.$5(c.type).setEventName("CLIENT_SENDING_MESSAGE").setCallID(d).setMsgID(c.msg_id).setSenderID(g).setReceiverID(a).log();this.$6(p,e);this.$4(a,b,"Sent",c.type+", "+c.msg_id)};c.logSentMessageSuccess=function(a,b,c,d){var e={call_id:b,msg_id:d,peer_id:a,type:c};b=b?b.toString():null;this.$5(c).setEventName("CLIENT_TRANSPORT_SUCCESS").setCallID(b).setMsgID(d.toString()).setSenderID(g).setReceiverID(a).log();this.$6(o,e)};c.logSentMessageFailure=function(a,b,c,d,e){var f={call_id:b,error_code:e,msg_id:d,peer_id:a,type:c},h=b?b.toString():null;this.$5(c).setEventName("CLIENT_TRANSPORT_ERROR").setCallID(h).setMsgID(d.toString()).setSenderID(a).setSenderID(g).setReceiverID(a).setResultCode(e).log();this.$6(n,f);this.$4(a,b,"Send Failed",c+", "+e)};c.logCallAction=function(a,b,c,d,e){var f={call_action:c,call_id:b,content:d,peer_id:a};e&&(f.trigger=e);this.$6(h,f);this.$4(a,b,"CallAction",c+", "+JSON.stringify(d))};c.logEvent=function(a,b,c){var d={call_id:b,content:c,peer_id:a};this.$6(k,d);this.$4(a,b,"Event",JSON.stringify(c))};c.logInfo=function(a,b,c){var d={call_id:b,content:c,peer_id:a};this.$6(l,d);this.$4(a,b,"Info",JSON.stringify(c))};c.logError=function(a,c,d){var e,f={call_id:c,content:d,peer_id:a};e=b("FBLogger")("rtweb").addMetadata("RT_WEB","CALL_ID",""+((e=c)!=null?e:"null")).addMetadata("RT_WEB","PEER_ID",""+((e=a)!=null?e:"null"));if(typeof d==="string")e.warn(d);else{var g=JSON.stringify(d);e.warn((e=g)!=null?e:"Unknown error")}this.$6(j,f);this.$4(a,c,"Error",JSON.stringify(d))};c.logErrorWithoutID=function(a){this.logError(null,null,a)};c.logEndCallSummary=function(a){if(!a)return;var c={call_id:a.callID,channel_session_id:b("ChannelClientID").getID(),content:a.toString(),peer_id:a.peerID,tag:"endcallstats"},d=babelHelpers["extends"]({},c,a.getExtraInfo());this.$6(i,d);this.$4(a.peerID,a.callID,"Call Summary",JSON.stringify(c))};c.logTsLogData=function(a,b,c,d){if(!b||!c)return;this.$6(q,{call_id:c,conf_name:d,time_series1:JSON.stringify(a)});this.$4(b,c,"TSLog Data",JSON.stringify(a))};c.doesContainSensitiveData=function(a){return String(a).indexOf("crypto")>-1};c.redactSensitiveData=function(a,b){if(a!==i){a=JSON.stringify(b);if(this.doesContainSensitiveData(a))return{redacted:!0}}return b};c.$6=function(a,c){c.page_id=b("pageID");c=this.redactSensitiveData(a,c);b("FBRTCConsoleLogger").getInstance().getLogHistory().log(a,c);b("MarauderLogger").log(a,b("FBRTCConsoleLogger").MODULE_NAME,c)};c.$4=function(a,c,d,e,f){f===void 0&&(f="DEBUG"),b("FBRTCConsoleLogger").getInstance().log(this.doesContainSensitiveData(e)?"redacted":e,a,c,d,f)};return a}();a.CallAction=Object.freeze({ANSWER_CALL:"answer_call",AUTO_DISABLE_VIDEO:"auto_disable_video",DENIED_PERMISSION:"denied_permission",END_CALL:"end_call",FAILED_GETTING_URI:"failed_getting_uri",OLD_URI:"old_uri",OPEN_POPUP:"open_popup",POPUP_OPENED:"popup_opened",RECEIVED_CALL:"received_call",SET_FULLSCREEN_ON:"set_fullscreen_on",SET_MUTE:"set_mute",SET_SELF_VIEW_ON:"set_self_view_on",SET_VIDEO_ON:"set_video_on",START_CALL:"start_call",START_SKYPE:"start_skype",TRY_NEW:"try_new",USER_SETTINGS_CHANGED:"user_settings_changed"});a.Trigger=Object.freeze({ADMIN_MESSAGE:"admin_message",CHAT_TAB_ICON_TOUR:"chat_tab_icon_tour",CHAT_TAB_ICON:"chat_tab_icon",CHAT_TAB_VOICE_ICON:"chat_tab_voice_icon",MULTIWAY_ADMIN_MESSAGE_JOIN_AUDIO_CALL_BUTTON:"multiway_admin_message_join_audio_call_button",MULTIWAY_ADMIN_MESSAGE_JOIN_VIDEO_CALL_BUTTON:"multiway_admin_message_join_video_call_button",MULTIWAY_ADMIN_MESSAGE_START_AUDIO_CALL_BUTTON:"multiway_admin_message_start_audio_call_button",MULTIWAY_ADMIN_MESSAGE_START_VIDEO_CALL_BUTTON:"multiway_admin_message_start_video_call_button",MULTIWAY_CHAT_TAB_SHEET_JOIN_CALL_BUTTON:"multiway_chat_tab_sheet_join_call_button",MULTIWAY_POPUP_START_CALL_BUTTON:"multiway_popup_start_call_button",MULTIWAY_THREAD_HEADER_AUDIO_BUTTON:"multiway_thread_header_audio_button",MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_AUDIO_BUTTON:"multiway_thread_header_join_audio_call_audio_button",MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_VIDEO_BUTTON:"multiway_thread_header_join_audio_call_video_button",MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_AUDIO_BUTTON:"multiway_thread_header_join_video_call_audio_button",MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_VIDEO_BUTTON:"multiway_thread_header_join_video_call_video_button",MULTIWAY_THREAD_HEADER_VIDEO_BUTTON:"multiway_thread_header_video_button",MULTIWAY_THREAD_LIST_JOIN_CALL_BUTTON:"multiway_thread_list_join_call_button",POPUP_CALL_START_BUTTON:"popup_start_call_button",REDIAL_BUTTON:"redial_button",RESET_CALL:"install_screen_sharing_ext_dialog",RETURN_CALL:"return_call",SKYPE_DEPRECATION_DIALOG:"skype_deprecation_dialog",TIMELINE_PROFILE:"timeline_profile",VC_PRECALL_SETUP:"vc_precall_setup",UNKNOWN:"unknown",WEB_MESSENGER:"web_messenger",TEAMWORK_USER_VIDEO_CALL_ITEM:"teamwork_user_video_call_item",TEAMWORK_USER_AUDIO_CALL_ITEM:"teamwork_user_audio_call_item"});a.Key=Object.freeze({BATTERY_START:"battery_start",BATTERY_END:"battery_end",CALL_TYPE:"call_type",CONNECTION_EFFECTIVE_TYPE:"conn_effective_type",CPU_CORES:"cpu_cores",DEVICE_INFO:"device_info",DEVICE_MEMORY:"device_memory",DEVICE_PIXEL_RATIO:"device_pixel_ratio",INITIATED_BY_PAGE_ID:"initiated_by_page_id",INITIATED_BY_APP_ID:"initiated_by_app_id",PEER_IS_MOBILE:"peer_is_mobile",RATING_SHOWN:"rating_shown",RATING:"rating5",EFFECT_COUNT:"rtc_effect_count",EFFECT_TOTAL_DURATION:"rtc_effect_total_duration",VIDEO_DURATION_WITH_FILTER:"rtc_video_duration_with_filter_enabled",SCREEN_DURATION:"screen_duration",SURVEY_CHOICE:"survey_choice",SURVEY_DETAILS:"survey_details",SURVEY_SHOWN:"survey_shown",MEDIA_INPUTS:"media_inputs",VIDEO_CAPABILITIES:"video_capabilities",CB_ACTIVE:"cb_active"});e.exports=a},null);
__d("FBRTCSupport",["RTCConfig","UserAgent","gkx"],function(a,b,c,d,e,f){var g={isWebrtcSupported:function(){return b("UserAgent").isBrowser("Chrome >= 28")||b("UserAgent").isBrowser("Firefox >= 25")||b("UserAgent").isBrowser("Edge >= 15.15042")||b("UserAgent").isBrowser("Edge (Chromium Based) >= 74.1")&&b("gkx")("932334")||b("UserAgent").isBrowser("Opera >= 20")||g.isSupportedSafariVersion()&&b("gkx")("875718")||b("UserAgent").isBrowser("Oculus Browser >= 6")&&b("gkx")("1188589")},isGroupCallWebtrcSupported:function(){return b("UserAgent").isBrowser("Chrome >= 28")||b("UserAgent").isBrowser("Edge (Chromium Based) >= 74.1")&&b("gkx")("932334")||b("UserAgent").isBrowser("Opera >= 20")||g.isSupportedSafariVersion()&&b("gkx")("875718")},isCollabSupported:function(){return g.isWebrtcSupported()&&(!!b("RTCConfig").CollabWhitelistedBrowserGK||b("UserAgent").isBrowser("Chrome >= "+65))},canUseUnifiedPlan:function(a){var c=b("UserAgent").isBrowser("Chrome >= 73")||b("UserAgent").isBrowser("Safari >= 12.2");if(a)return c;a=b("gkx")("919244")&&c;return a||b("UserAgent").isBrowser("Mobile Safari >= 12.1.1")},isSupportedSafariVersion:function(){return b("UserAgent").isBrowser("Safari >= 12.1")||b("UserAgent").isBrowser("Mobile Safari >= 12.1")},isMobileDevice:function(){return b("UserAgent").isPlatform("Android")||b("UserAgent").isPlatform("iOS")},isVideoFilterEffectSupported:function(){return!g.isMobileDevice()&&(b("UserAgent").isBrowser("Chrome >= 51")||b("UserAgent").isBrowser("Opera >= 36"))},videoEscalationByUnmuteWorkaround:function(){return b("UserAgent").isBrowser("Firefox < 60")||b("UserAgent").isBrowser("Edge")},isChromiumBased:function(){return b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Opera")||b("UserAgent").isBrowser("Edge (Chromium Based) >= 74.1")&&b("gkx")("932334")}};e.exports=g},null);
__d("FBRTCMessageListener",["invariant","Bootloader","FBMqttChannel","FBRTCConstants","FBRTCLocalMessageQueue","FBRTCSupport","RTWebExperiments","Run","gkx","guid","mixInEventEmitter"],function(a,b,c,d,e,f,g){"use strict";var h=b("FBRTCConstants").ChildWindowMessageType,i=45*1e3,j=[],k=null,l=null,m,n=null,o=null,p=!1,q=!1,r=null,s=null,t=null,u=null,v=null,w=[];a={logCheckpoint:function(a){b("Bootloader").loadModules(["RTWebUserActionLogger"],function(b){b.logCheckpoint({checkpoint:a})},"FBRTCMessageListener")},init:function(a,c){var d=this;if(p)return;p=!0;q=a;r=c;this.subscribeToMqtt();if(b("FBRTCSupport").isWebrtcSupported()&&window.addEventListener){var e=a?this._handleWindowMessageToChild.bind(this):this._handleWindowMessageToParent.bind(this);window.addEventListener("message",e,!1)}a&&this._connectToParentWindow(c);b("Run").onUnload(function(){d.unsubscribeToAll()})},subscribeToMqtt:function(){var a=this;w.push("/webrtc");b("FBMqttChannel").subscribe("/webrtc",function(b){b=JSON.parse(b);a._onMessage(b)});w.push("/rtc_multi");b("FBMqttChannel").subscribe("/rtc_multi",function(b){b=JSON.parse(b);a._onMultiwayMessage(b)});w.push("/onevc");b("FBMqttChannel").subscribe("/onevc",function(b){b=JSON.parse(b);a._onOneVCMessage(b)})},unsubscribeToAll:function(){w.forEach(function(a){b("FBMqttChannel").unsubscribeAll(a)})},setParentWindowNonce:function(a){n=a},generateNewNonce:function(){o=b("guid")();return o},setMultiwayMessageHandler:function(a){s&&g(0,1011),s=a},removeMultiwayMessageHandler:function(){s=null},_emit:function(a,b){this.emit(a,b)},_onMultiwayMessage:function(a){this._emit("multiwayMessageReceived",a),s&&s(a)},setOneVCMessegeHandler:function(a){t==null&&(t=a)},_onOneVCMessage:function(a){t!=null&&t(a)},setMessageHandler:function(a){k&&g(0,1013);k=a;while(j.length)k(j.shift())},removeMessageHandler:function(){k=null},removeOneVCMessageHandler:function(){t=null},setParentWindowStartCallHandler:function(a){u=a},_onMessage:function(a){a.from&&(a.from=a.from.toString()),this._emit("messageReceived",a),k?k(a):j.push(a),q||this._passOrQueueToChildWindow(a)},_connectToParentWindow:function(a){var b=this;if(window.opener&&window.opener.postMessage){a={type:h.CHILD_WINDOW_READY,nonce:n,childNonce:this.generateNewNonce(),peerID:a};var c=new MessageChannel();c.port1.onmessage=function(a){b._handleWindowMessageToChild(a,!0)};window.opener.postMessage(a,window.location.origin,[c.port2])}},_verifyWindowMessage:function(a){return Boolean(a.origin===window.location.origin&&a.data&&o!==null&&a.data.nonce===o)},_verifyPortMessage:function(a){return Boolean(o!==null&&(a==null?void 0:(a=a.data)==null?void 0:a.nonce)===o)},_handleWindowMessageToParent:function(a){if(!this._verifyWindowMessage(a))return;if(a.data.type===h.CHILD_WINDOW_READY){var c=a.data,d=c.childNonce;c=c.peerID;b("gkx")("1098789")&&a.ports!=null&&Array.isArray(a.ports)&&a.ports[0]!=null&&(v=a.ports[0]);this.setParentWindowNonce(d);this._setChildWindow(a.source);this._startCallInChildWindow(c);this.generateNewNonce();this._replayQueuedMessagesToChild(c,l)}},_handleWindowMessageToChild:function(a,c){c===void 0&&(c=!1);if(c&&!this._verifyPortMessage(a)||!c&&!this._verifyWindowMessage(a))return;a.data.type===h.CHILD_WINDOW_MESSAGE&&this._onMessage(a.data.message);if(a.data.type===h.CHILD_WINDOW_START_CALL&&u){c=a.data.offer;!c&&r&&(c=b("FBRTCLocalMessageQueue").getPeerOfferFromStorage(r),c&&b("RTWebExperiments").passOfferWithWindowMessages()&&this.logCheckpoint("got_offer_from_storage_while_in_experiment"));u(c)}},_replayQueuedMessagesToChild:function(a,c){var d=this;b("FBRTCLocalMessageQueue").drainQueue(a,function(a){d._postToChildWindowMessage(c,a)})},_setChildWindow:function(a){l=a,window.clearTimeout(m),m=window.setTimeout(function(){l=null},i)},_postToChildWindowMessage:function(a,c){c={type:h.CHILD_WINDOW_MESSAGE,nonce:n,message:c};b("gkx")("1098789")&&v!=null?v.postMessage(c):a.postMessage(c,window.location.origin)},_passOrQueueToChildWindow:function(a){l&&this._postToChildWindowMessage(l,a),b("RTWebExperiments").enableCallCollisionFix()&&b("FBRTCLocalMessageQueue").enqueueMessage(a.from,a.id,a)},_startCallInChildWindow:function(a){if(l){a={type:h.CHILD_WINDOW_START_CALL,nonce:n,offer:b("RTWebExperiments").passOfferWithWindowMessages()?b("FBRTCLocalMessageQueue").pluckOffer(a):null};b("gkx")("1098789")&&v!=null?v.postMessage(a):l.postMessage(a,window.location.origin)}},listenOnce:function(a,b){this.once(a,b)}};b("mixInEventEmitter")(a,{messageReceived:!0,multiwayMessageReceived:!0});e.exports=a},null);
__d("RTCWebUserActionsDebugTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:RTCWebUserActionsDebugLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:RTCWebUserActionsDebugLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:RTCWebUserActionsDebugLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setCallID=function(a){this.$1.call_id=a;return this};c.setCallType=function(a){this.$1.call_type=a;return this};c.setCheckpoint=function(a){this.$1.checkpoint=a;return this};c.setClientTime=function(a){this.$1.client_time=a;return this};c.setCodebaseVersion=function(a){this.$1.codebase_version=a;return this};c.setComponent=function(a){this.$1.component=a;return this};c.setConferenceName=function(a){this.$1.conference_name=a;return this};c.setConferenceState=function(a){this.$1.conference_state=a;return this};c.setDeviceID=function(a){this.$1.device_id=a;return this};c.setErrorDomain=function(a){this.$1.error_domain=a;return this};c.setErrorType=function(a){this.$1.error_type=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setEventTimeElapsed=function(a){this.$1.event_time_elapsed=a;return this};c.setIsCaller=function(a){this.$1.is_caller=a;return this};c.setMediaType=function(a){this.$1.media_type=a;return this};c.setPage=function(a){this.$1.page=a;return this};c.setSurface=function(a){this.$1.surface=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};return a}();c={call_id:!0,call_type:!0,checkpoint:!0,client_time:!0,codebase_version:!0,component:!0,conference_name:!0,conference_state:!0,device_id:!0,error_domain:!0,error_type:!0,event:!0,event_time_elapsed:!0,is_caller:!0,media_type:!0,page:!0,surface:!0,time:!0,vc:!0,weight:!0};e.exports=a},null);
__d("RTCWebUserActionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:RTCWebUserActionsLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:RTCWebUserActionsLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:RTCWebUserActionsLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setCallID=function(a){this.$1.call_id=a;return this};c.setCallType=function(a){this.$1.call_type=a;return this};c.setCheckpoint=function(a){this.$1.checkpoint=a;return this};c.setClientTime=function(a){this.$1.client_time=a;return this};c.setCodebaseVersion=function(a){this.$1.codebase_version=a;return this};c.setComponent=function(a){this.$1.component=a;return this};c.setConferenceName=function(a){this.$1.conference_name=a;return this};c.setConferenceState=function(a){this.$1.conference_state=a;return this};c.setDeviceID=function(a){this.$1.device_id=a;return this};c.setErrorDomain=function(a){this.$1.error_domain=a;return this};c.setErrorType=function(a){this.$1.error_type=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setEventTimeElapsed=function(a){this.$1.event_time_elapsed=a;return this};c.setIsCaller=function(a){this.$1.is_caller=a;return this};c.setMediaType=function(a){this.$1.media_type=a;return this};c.setPage=function(a){this.$1.page=a;return this};c.setSurface=function(a){this.$1.surface=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};return a}();c={call_id:!0,call_type:!0,checkpoint:!0,client_time:!0,codebase_version:!0,component:!0,conference_name:!0,conference_state:!0,device_id:!0,error_domain:!0,error_type:!0,event:!0,event_time_elapsed:!0,is_caller:!0,media_type:!0,page:!0,surface:!0,time:!0,vc:!0,weight:!0};e.exports=a},null);
__d("RTWebUserActionLogger",["CurrentUser","FBRTCConsoleLogger","FBRTCSupport","RTCWebUserActionsDebugTypedLogger","RTCWebUserActionsTypedLogger","RTWebLoggingSharedInstance","immutable","performanceNow"],function(a,b,c,d,e,f){"use strict";var g,h=b("immutable").Map;a=function(){function a(){this.$2=h(),this.$3=new Set(),this.$4=new Set(),this.$5=b("RTWebLoggingSharedInstance").getDeviceID(),this.$6=this.$7(),this.clearCache()}var c=a.prototype;c.clearCache=function(){this.$1={callID:void 0,callType:void 0,mediaType:void 0,conferenceName:void 0,conferenceState:void 0}};c.logImpression=function(a){this.logEvent(babelHelpers["extends"]({eventName:"impression"},a))};c.logPreCallImpression=function(a){this.clearCache(),this.logImpression(a)};c.logPreCallClick=function(a){this.clearCache(),this.logClick(a)};c.logClick=function(a){this.logEvent(babelHelpers["extends"]({eventName:"tap"},a))};c.logError=function(a){this.logEvent(babelHelpers["extends"]({eventName:"error"},a))};c.startTimer=function(a){var c=(g||(g=b("performanceNow")))();this.$2=this.$2.set(a,c);this.logCheckpoint({checkpoint:a+"_timerStart"});this.$8(a,{startTime:c})};c.logStopTimer=function(a){var b=a.checkpointName===void 0?a.timerName:a.checkpointName,c=a.event||{};c.timeElapsed=this.$9(a.timerName);this.logCheckpoint(babelHelpers["extends"]({checkpoint:b+"_timerEnd"},c));return c.timeElapsed};c.logCheckpoint=function(a){this.logEvent(babelHelpers["extends"]({eventName:"checkpoint"},a))};c.$10=function(a){return a===null||a===void 0};c.logEvent=function(a){var b=this.$1;b.callID=this.$10(a.callID)?b.callID:a.callID;b.callType=a.callType||b.callType;b.conferenceState=a.conferenceState||b.conferenceState;b.conferenceName=this.$10(a.conferenceName)?b.conferenceName:a.conferenceName;b.isCaller=a.isCaller==null?b.isCaller:a.isCaller;b.mediaType=a.mediaType||b.mediaType;this.$11(a,b);b=this.$12(a,b);this.$8(a.eventName,b)};c.$12=function(a,c){var d=new(b("RTCWebUserActionsTypedLogger"))();d.setCallType(c.callType).setDeviceID(this.$5).setClientTime(Date.now()).setErrorDomain(a.errorDomain).setErrorType(a.errorType).setComponent(a.component).setConferenceState(c.conferenceState).setEvent(a.eventName).setMediaType(c.mediaType).setPage(this.$6).setCallID(c.callID).setConferenceName(c.conferenceName).setSurface(a.surface).setCheckpoint(a.checkpoint).setEventTimeElapsed(a.timeElapsed).setIsCaller(c.isCaller).setCodebaseVersion("Old Codebase").log();return d.getData()};c.$11=function(a,c){var d=new(b("RTCWebUserActionsDebugTypedLogger"))();d.setCallType(c.callType).setDeviceID(this.$5).setClientTime(Date.now()).setErrorDomain(a.errorDomain).setErrorType(a.errorType).setComponent(a.component).setConferenceState(c.conferenceState).setEvent(a.eventName).setMediaType(c.mediaType).setPage(this.$6).setCallID(c.callID).setConferenceName(c.conferenceName).setSurface(a.surface).setCheckpoint(a.checkpoint).setEventTimeElapsed(a.timeElapsed).setIsCaller(c.isCaller).setCodebaseVersion("Old Codebase").log();return d.getData()};c.getCallType=function(a,b){b===void 0&&(b=!1);if(a===null||a===void 0)return null;if(a)return"mw";else if(b)return"escalated";else return"p2p"};c.getAudioVideoComponent=function(a){return a===null||a===void 0?null:a?"audio_button":"video_button"};c.getMediaType=function(a,b){b===void 0&&(b=!1);if(b)return"escalated";else if(a)return"audio";else return"video"};c.logErrorOnceforDomain=function(a,b){this.$3.has(a)||(this.$3.add(a),this.logError({errorDomain:a,errorType:b.toString()}))};c.logCheckpointOnceForDomain=function(a){var b=a.checkpoint;this.$4.has(b)||(this.$4.add(b),this.logCheckpoint(a))};c.clearLoggedDomains=function(){this.$3.clear(),this.$4.clear()};c.getWebLoggerInfoFromStore=function(a){a=a.callInfo;var b=a.callID,c=a.conferenceName;a=a.conferenceState;return{callID:b,conferenceName:c,conferenceState:a}};c.$7=function(){if(b("FBRTCSupport").isMobileDevice())return"mweb";else if(b("CurrentUser").isWorkUser())return"workplace";var a=window.location.hostname;if(a.search("facebook")!==-1)return"facebook";else if(a.search("messenger")!==-1)return"messenger_dot_com";return a};c.$9=function(a){var c=this.$2.get(a);if(c){this.$2=this.$2.remove(a);return parseInt((g||(g=b("performanceNow")))()-c,10)}return null};c.$8=function(a,c){a=a==null?"null":a;b("FBRTCConsoleLogger").getInstance().getLogHistory().log(a,JSON.stringify(c))};return a}();e.exports=new a()},null);
__d("WorkDoNotDisturbSettingsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:WorkDoNotDisturbSettingsLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:WorkDoNotDisturbSettingsLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:WorkDoNotDisturbSettingsLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setEvent=function(a){this.$1.event=a;return this};c.setOption=function(a){this.$1.option=a;return this};c.setSource=function(a){this.$1.source=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};return a}();c={event:!0,option:!0,source:!0,time:!0,weight:!0};e.exports=a},null);
__d("MercuryDeliveryState",["MercuryIDs","MercuryServerRequests","MercurySingletonProvider","MercuryThreadIDMap","MercuryThreadInformer","UserActivity","debounceAcrossTransitions"],function(a,b,c,d,e,f){"use strict";a=function(){a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};function a(a){var c=this;this.$8=function(){if(c.$5.length===0&&Object.keys(c.$6).length===0)return;var a=c.$5.map(function(a){return a.message_id});a&&c.$2.sendDeliveryReceipts(a,c.$6);c.$6={};c.$5=[]};this.$1=a;this.$2=b("MercuryServerRequests").getForFBID(this.$1);this.$3=b("MercuryThreadInformer").getForFBID(this.$1);this.$4=b("MercuryThreadIDMap").getForFBID(this.$1);this.$5=[];this.$6={};this.$3.subscribe("messages-received",this.$7.bind(this));b("UserActivity").subscribe(b("debounceAcrossTransitions")(this.$8,300,this))}var c=a.prototype;c.$7=function(a,b){var c=this;for(var d in b){a=b[d];a.forEach(function(a){c.$9(a)&&(c.$5.push(a),c.$4.getServerIDFromClientID(d,function(b){c.$6[b]||(c.$6[b]=[]),c.$6[b].push(a.message_id)}))})}this.$8()};c.$9=function(a){var c=a.author?b("MercuryIDs").getUserIDFromParticipantID(a.author):null;if(c===this.$1)return!1;return!a.is_unread?!1:!0};return a}();var g=new(b("MercurySingletonProvider"))(a);e.exports=a},null);
__d("MNCommerceActionTypes",["keyMirrorRecursive"],function(a,b,c,d,e,f){"use strict";a={RECEIPT:{LOADED:null,LOAD_ERROR:null,RELOAD:null},SHIPMENT:{LOADED:null,LOAD_ERROR:null,RELOAD:null},DIALOG:{SHOW:null,HIDE:null},RETAIL_ITEM:{LOADED:null,LOAD_ERROR:null,RELOAD:null},PROMOTION_STATE:{LOADED:null,LOAD_ERROR:null,RELOAD:null},TRANSACTION_INVOICE:{LOADED:null,LOAD_ERROR:null,RELOAD:null},BOT_REVIEW_STATE:{LOADED:null,LOAD_ERROR:null,RELOAD:null}};c=b("keyMirrorRecursive")(a);e.exports=c},null);
__d("MNCommerceDialogStateStore",["FluxStore","MessengerDispatcher","MNCommerceActionTypes"],function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this,b("MessengerDispatcher"))||this;c.$MNCommerceDialogStateStore1=null;c.$MNCommerceDialogStateStore2=null;return c}var d=c.prototype;d.__onDispatch=function(a){var c=a.type;switch(c){case b("MNCommerceActionTypes").DIALOG.SHOW:this.$MNCommerceDialogStateStore1=a.dialogContainer;this.$MNCommerceDialogStateStore2=a.state;this.__emitChange();break;case b("MNCommerceActionTypes").DIALOG.HIDE:this.$MNCommerceDialogStateStore1=null;this.$MNCommerceDialogStateStore2=null;this.__emitChange();break}};d.getDialogContainer=function(){return this.$MNCommerceDialogStateStore1};d.getState=function(){return this.$MNCommerceDialogStateStore2};return c}(b("FluxStore"));a.__moduleID=e.id;e.exports=new a()},null);
__d("MNCommerceDialogContainer.react",["MNCommerceDialogStateStore","PureStoreBasedStateMixin","React","createReactClass_DEPRECATED"],function(a,b,c,d,e,f){"use strict";var g=b("React");a=b("createReactClass_DEPRECATED")({displayName:"MNCommerceDialogContainer",mixins:[b("PureStoreBasedStateMixin")(b("MNCommerceDialogStateStore"))],statics:{calculateState:function(){var a=b("MNCommerceDialogStateStore").getDialogContainer();return{dialogContainer:a}}},render:function(){var a=this.state.dialogContainer;return!a?null:g.jsx(a,{})}});e.exports=a},null);
__d("WorkChatAvailabilityStatusDispatcher",["ExplicitRegistrationReactDispatcher"],function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){return a.call(this,b)||this}var c=b.prototype;c.dispatch=function(b){a.prototype.dispatch.call(this,b)};return b}(b("ExplicitRegistrationReactDispatcher"));e.exports=new a({strict:!1})},null);
__d("WorkChatAvailabilityStatusActions",["WorkChatAvailabilityStatusDispatcher","keyMirror"],function(a,b,c,d,e,f){"use strict";var g=b("keyMirror")({STATUS_CHANGED:"",TOGGLE_RECURRING_DND_DIALOG:""});function a(a){b("WorkChatAvailabilityStatusDispatcher").dispatch({type:g.STATUS_CHANGED,users:a})}function c(){b("WorkChatAvailabilityStatusDispatcher").dispatch({type:g.TOGGLE_RECURRING_DND_DIALOG})}e.exports={Types:g,changeStatus:a,toggleRecurringDNDDialog:c}},null);
__d("WorkGalahadPresenceBadgeDisplay.react",["CurrentUser","React","RelayHooks","WorkGalahadActiveBadge.react","WorkGalahadDNDBadge.react","WorkplaceDoNotDisturbUtils","nullthrows","useWorkUserStatus","WorkGalahadPresenceBadgeDisplay_user.graphql"],function(a,b,c,d,e,f){"use strict";var g,h=b("React");b("RelayHooks").graphql;var i=b("RelayHooks").useFragment;function a(a){var c=a.size,d=a.user;a=a.xstyle;d=i(g!==void 0?g:g=b("WorkGalahadPresenceBadgeDisplay_user.graphql"),d);var e=b("useWorkUserStatus")(d.id),f=e.endDate;e=e.userStatus;if(e==="doNotDisturb")return h.jsx(b("WorkGalahadDNDBadge.react"),{xstyle:a,size:c,tooltip:d.id===b("CurrentUser").getID()?b("WorkplaceDoNotDisturbUtils").getHumanReadableSelfDescription(f):b("WorkplaceDoNotDisturbUtils").getHumanReadableDescriptionWithUserName(b("nullthrows")(d.name),f)});else if(e==="active")return h.jsx(b("WorkGalahadActiveBadge.react"),{xstyle:a,size:c});return null}e.exports=a},null);
__d("WorkUserAvailabilityStatusSource",["keyMirror"],function(a,b,c,d,e,f){"use strict";e.exports=b("keyMirror")({NONE:null,PHONE_CALENDAR_SYNC:null,MANUAL:null,SCHEDULED:null,FB_ONLY_OFFICE_STATUS:null,FB_ONLY_BEACH_MODE:null,FB_ONLY_SCHEDULED_MODE:null,FB_ONLY_BALANCE_BOT:null,WEEKLY_DND_SCHEDULE:null,WEEKLY_DND_SCHEDULE_OVERRIDE:null})},null);
__d("PreloadedRelayQueryRendererContext",["React"],function(a,b,c,d,e,f){"use strict";a=b("React");c=a.createContext(null);e.exports=c},null);
__d("RelayAsyncDataPreloader",["Promise","FBLogger","PreloadedRelayQueryRendererContext","RelayAPIConfig","RelayPrefetchedResponseProvider","RelayPrefetchedStreamCache","promiseDone","stableStringifyPrefetchedRelayVariablesWithActor"],function(a,b,c,d,e,f){"use strict";var g=function(){function a(a,b,c,d){this.$4=!1,this.$1=a,this.$2=b,this.$3=c,this.$5=d}var c=a.prototype;c.get=function(a,c,d){if(!this.$4)if(this.$2!==c)b("FBLogger")("RelayQueryPreloader").addMetadata("RELAY_PRELOADER","QUERY_ID",c).mustfix("Preloader QueryID Mismatch: %s !== %s (pinning status: %s)",c,this.$2,this.$5);else if(this.$1!==a)b("FBLogger")("RelayQueryPreloader").addMetadata("RELAY_PRELOADER","QUERY_ID",c).mustfix("Preloader ActorID Mismatch: %s !== %s (pinning status: %s)",a,this.$1,this.$5);else{var e=b("stableStringifyPrefetchedRelayVariablesWithActor")(this.$1,this.$3),f=b("stableStringifyPrefetchedRelayVariablesWithActor")(a,d);e!==f&&b("FBLogger")("RelayQueryPreloader").addMetadata("RELAY_PRELOADER","QUERY_ID",c).mustfix("Preloader Variables Mismatch: %s !== %s (pinning status: %s)",e,f,this.$5)}this.$4=!0;return b("RelayPrefetchedResponseProvider").get(a,c,d)};return a}();a=function(){function a(a){var c=this,d=a.asyncDataPreloader,e=a.queryID,f=a.queryVariables,g=a.pinnedStatus;a=a.actorID;this.$3=(a=a)!=null?a:b("RelayAPIConfig").actorID;b("RelayPrefetchedStreamCache").registerPreloader(d.getID(),e,f,this.$3);this.$1=g!=null?String(g):"(unknown)";this.$2=e;this.$4=f;this.$5=new(b("Promise"))(function(a,d){b("RelayPrefetchedStreamCache").subscribe(c.$3,e,f,{complete:a,error:d,next:a,start:function(){}})})}var c=a.prototype;c.getPrefetchedResponseCache=function(){this.$6||(this.$6=new g(this.$3,this.$2,this.$4,this.$1));return this.$6};c.getContextProvider=function(){return b("PreloadedRelayQueryRendererContext").Provider};c.getQueryVariables=function(){return this.$4};c.onLoaded=function(a){b("promiseDone")(this.$5.then(function(b){a(b);return b}));return this};c.onError=function(a){b("promiseDone")(this.$5["catch"](a));return this};return a}();e.exports=a},null);