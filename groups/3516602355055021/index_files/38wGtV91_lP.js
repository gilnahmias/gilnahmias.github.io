if (self.CavalryLogger) { CavalryLogger.start_js(["zJedH"]); }

__d("AccessibilityNub",["csx","cx","Bootloader","CSS","DOM","DOMQuery","Event","JSLogger","JSXDOM","Layer","NubController","SiteData","Toggler","URI","debounceAcrossTransitions"],function(a,b,c,d,e,f,g,h){var i,j=b("JSLogger").create("a11y_nub"),k,l,m={},n={unlabeledFormElems:function(a){var c=document.body;a&&(c=a.getTarget());var d={};b("DOMQuery").scry(document.body,"label").forEach(function(a){a.getAttribute("for")&&(d[a.getAttribute("for")]=a)});Array.prototype.concat(b("DOMQuery").scry(c,"input"),b("DOMQuery").scry(c,"select"),b("DOMQuery").scry(c,"textarea")).forEach(function(a){!b("CSS").hasClass(a,"unlabeled")&&!a.getAttribute("placeholder")&&!a.getAttribute("aria-label")&&!a.getAttribute("aria-labelledby")&&a.getAttribute("type")!="hidden"&&a.parentNode.nodeName!="LABEL"&&(!a.id||!d[a.id])&&b("CSS").addClass(a,"unlabeled")})},simulateHCM:function(a){b("CSS").conditionClass(document.documentElement,"highContrast",b("CSS").hasClass(document.documentElement,"simulateHCM"))}};function o(){return{rev:b("SiteData").client_revision,host:window.location.host,path:window.location.pathname}}function p(a,c,d){var e=[];for(var f=0;f<c.attributes.length;f++){var g;e.push((g=b("JSXDOM")).span({className:"_52y7"},g.span({className:"_52y9"},c.attributes[f].name),g.span({className:"_52y8"},"="),g.span({className:"_52ya"},'"'+c.attributes[f].value+'"')))}g=null;if(d){f=b("JSXDOM").a({className:"_42ft _42fu mts",href:"#"},"select this node");b("Event").listen(f,"click",this.checkFeatureReport.bind(this,c));g=b("JSXDOM").div(null,f)}else b("CSS").addClass(c,"_3oxt"),l&&b("CSS").removeClass(l,"_3oxt"),l=c;d=b("JSXDOM").tr(null,b("JSXDOM").td({className:"_156s fwb prm"},a+":",g),b("JSXDOM").td({className:"_52y6"},b("JSXDOM").span({className:"_52y8"},"<"),b("JSXDOM").span({className:"_52y9"},c.nodeName.toLowerCase()+" "),e,b("JSXDOM").span({className:"_52y8"},"/>")));return d}a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(c,d,e){var f;f=a.call(this)||this;a.prototype.init.call(babelHelpers.assertThisInitialized(f),c);f.reportDialog=d;f.featureDialog=e;f.featureDialog.subscribe("confirm",f.runFeatureReport.bind(babelHelpers.assertThisInitialized(f)));b("Toggler").subscribe("show",function(a,c){c.active&&b("CSS").matchesSelector(c.active,"._52bs")&&j.log("shown",o())});b("Event").listen(c,"click",f.enableFeature.bind(babelHelpers.assertThisInitialized(f)));b("Event").listen(b("DOMQuery").find(c,"a._52bt"),"click",f.logDexClick.bind(babelHelpers.assertThisInitialized(f)));b("Event").listen(b("DOMQuery").find(f.reportDialog.getRoot(),"a.submitBug"),"click",f.logBugReport.bind(babelHelpers.assertThisInitialized(f)));b("Event").listen(b("DOMQuery").find(c,"a.featureReport"),"click",f.findFeatureReportNode.bind(babelHelpers.assertThisInitialized(f)));b("DOMQuery").scry(c,"a").forEach(function(a){a.href=a.href||"#",a.removeAttribute("tabindex")});return f}var d=c.prototype;d.logDexClick=function(){j.log("dex",o())};d.logBugReport=function(){j.log("bugReport",Object.assign(o(),{type:k}))};d.enableFeature=function(a){a=a.getTarget();if(b("CSS").matchesSelector(a,"._6aj")){var c=a.getAttribute("data-feature");a=a.parentNode;b("CSS").toggleClass(document.documentElement,c);b("CSS").toggleClass(a,"selected");b("CSS").hasClass(a,"selected")&&j.log("feature",Object.assign(o(),{key:c}));n[c]&&(n[c](),b("CSS").hasClass(a,"selected")?m[c]=b("Event").listen(document.body,"DOMNodeInserted",b("debounceAcrossTransitions")(n[c],250,this)):m[c]&&m[c].remove())}};d.findFeatureReportNode=function(a){this.hide();var c=function(a){var d=a.target;b("CSS").removeClass(document.body,"_3ra9");document.body.removeEventListener("click",c,!0);a.stopPropagation();a.preventDefault();this.checkFeatureReport(d)}.bind(this);document.body.addEventListener("click",c,!0);b("CSS").addClass(document.body,"_3ra9")};d.checkFeatureReport=function(a){var c=a.parentNode,d=b("DOMQuery").find(this.featureDialog.getContentRoot(),"div._6ak");b("DOM").empty(d);var e=b("JSXDOM").a({href:"#",className:"fwb"},"fade the dialog"),f=b("JSXDOM").div({className:"mbm"},"Tests will run over the selected element and its children. The element will have an outline (which you may need to ",e," to see). If you do not see your selected node outlined, you can walk up the DOM tree by selecting parent nodes.");b("Event").listen(e,{mouseover:function(){b("CSS").addClass(document.documentElement,"showSelectedNode")},mouseout:function(){b("CSS").removeClass(document.documentElement,"showSelectedNode")}});e=b("JSXDOM").table({className:"_156r"});b("DOM").appendContent(e,p.call(this,"Selected node",a));c&&b("DOM").appendContent(e,p.call(this,"Parent node",c,!0));b("DOM").appendContent(d,[f,e]);this.featureDialog.show()};d.runFeatureReport=function(){var a=l;b("CSS").removeClass(a,"_3oxt");this.featureDialog.hide();var c=b("DOMQuery").scry(this.featureDialog.getContentRoot(),'[name="testLayer"]')[0].checked;b("Bootloader").loadModules(["accessibilityFeatureTestFinder"],function(a,c,d){d(a,c,function(a){j.log("featureReport",Object.assign(o(),{tests:a.length}));if(a.length)this.runReport(a,"feature");else{a=b("DOMQuery").find(this.reportDialog.getContentRoot(),"div._6ak");b("DOM").setContent(a,"No valid tests found for the selected node.");b("CSS").hide(b("DOMQuery").find(this.reportDialog.getRoot(),"a.submitBug"));this.reportDialog.show()}}.bind(this))}.bind(this,a,c),"AccessibilityNub")};d.runPageReport=function(a){b("Bootloader").loadModules(["accessibilityHeaderTests","accessibilityLandmarkTests","accessibilityLinkTests","accessibilityImageTests","accessibilityFormTests"],function(a,b,c,d,e){a=[new a(),new b(),new c(),new d(),new e()];j.log("pageReport",o());this.runReport(a,"page")}.bind(this),"AccessibilityNub")};d.runReport=function(a,c){this.hide();this.reportDialog.hide();var d=a.length,e={};a.forEach(function(a){var f=a.subscribe("done",function(){a.unsubscribe(f),d--,d||(this.generateResults(e,c),setTimeout(function(){var a=b("Layer").getTopmostLayer();a&&a.hide();this.reportDialog.show()}.bind(this),0))}.bind(this));a.reset();var g=a.name;e[g]||(e[g]={tests:{},score:0,maxScore:0});a.runTests(function(a){var b=a.name;e[g].tests[b]||(e[g].tests[b]={messages:{},score:0,maxScore:0});e[g].score+=a.score;e[g].maxScore+=a.maxScore;e[g].tests[b].score+=a.score;e[g].tests[b].maxScore+=a.maxScore;a.messages.forEach(function(a){e[g].tests[b].messages[a[1]]||(e[g].tests[b].messages[a[1]]=[a[0]]),a[2]&&e[g].tests[b].messages[a[1]].push(a[2])})})}.bind(this))};d.generateResults=function(a,c){k=c;var d=b("DOMQuery").find(this.reportDialog.getContentRoot(),"div._6ak");b("DOM").empty(d);var e=0,f=0,g={},h=[],m;for(var n in a){var p;f+=a[n].score;e+=a[n].maxScore;var q=(p=b("JSXDOM")).a({href:"#",className:"rfloat",role:"button"},"details"),r=p.div({className:"clearfix"},q,p.div({className:"fsl fwb fcb"},n,p.span({className:"_6al"},a[n].score+" of "+a[n].maxScore))),s=p.tr(null);for(m=0;m<a[n].maxScore;m++)b("DOM").appendContent(s,b("JSXDOM").td({className:m<a[n].score?"good":"bad"}));s=p.table({className:"_xpe"},s);var t=p.div({className:"_6an"});for(var u in a[n].tests){var v=b("JSXDOM").div({className:"clearfix _6ap"},b("JSXDOM").div({className:"rfloat _6aq"},a[n].tests[u].score," of ",a[n].tests[u].maxScore),b("JSXDOM").div({className:"fsm fwb fcg mts"},u)),w=[];for(var x in a[n].tests[u].messages){var y=a[n].tests[u].messages[x],z=y.shift()?" bonus":"",A=null;y.length?(A=b("JSXDOM").a({href:"#"},"see nodes"),b("Event").listen(A,{mouseover:function(a){b("CSS").addClass(document.documentElement,"displayErrorNodes"),a.forEach(function(a){b("CSS").addClass(a,"errorNode")})}.bind(null,y),mouseout:function(a){b("CSS").removeClass(document.documentElement,"displayErrorNodes"),a.forEach(function(a){b("CSS").removeClass(a,"errorNode")})}.bind(null,y),click:function(b,a){b.forEach(function(a){})}.bind(null,y,x)}),z||(g[x]||(g[x]=[]),g[x]=g[x].concat(y))):z||h.push(x);w.push(b("JSXDOM").div({className:"message"+z},x," ",A))}b("DOM").appendContent(t,Array.prototype.concat([v],w))}b("Event").listen(q,"click",b("CSS").toggleClass.bind(null,t,"detailView"));b("DOM").appendContent(d,p.div({className:"_6ao"},r,s,t))}var B;if(c=="page")y=e-f,B=y+' Accessibility Page Report Failures for "'+window.location.pathname+'"\n\nThese errors were found by running an accessibility page report. See https://www.facebook.com/groups/454107521304535/permalink/502595983122355 for more information on how to run this report.\n\n"'+window.location.href+'" scored a '+f+" out of a possible "+e+". The following test failures were reported:\n",h.forEach(function(a){B+="\n   \u2022 "+a});else{y=Object.keys(g).length;z=l;B=y+" Accessibility Feature Report Failures\n\nThese errors were found by running an accessibility feature report. See https://www.facebook.com/groups/454107521304535/permalink/502595983122355 for more information on how to run this report.\n\nURL: "+window.location.href+"\n\nSelected node:\n\n<"+z.nodeName.toLowerCase();for(m=0;m<z.attributes.length;m++)B+=" "+z.attributes[m].name+'="'+z.attributes[m].value+'"';B+=" />\n\nThe following test failures were reported:";for(m in g)B+="\n\n   \u2022 "+m+" (for the following nodes):",g[m].forEach(function(a){B+="\n<"+a.nodeName.toLowerCase();for(var b=0;b<a.attributes.length;b++)B+=" "+a.attributes[b].name+'="'+a.attributes[b].value+'"';B+=" />"})}A=b("DOMQuery").find(this.reportDialog.getRoot(),"a.submitBug");if(h.length||Object.keys(g).length){v=new(i||(i=b("URI")))("/ajax/bugs/employee_report");v.addQueryData("defaultText",B);A.setAttribute("ajaxify",v);b("CSS").show(A)}else b("CSS").hide(A);j.log("results",Object.assign(o(),{type:c,score:f,max:e}))};return c}(b("NubController"));e.exports=a},null);